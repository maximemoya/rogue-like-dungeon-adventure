(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7670,e=>{"use strict";e.s(["default",0,function(){for(var e,t,r=0,i="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=function e(t){var r,i,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t)if(Array.isArray(t)){var o=t.length;for(r=0;r<o;r++)t[r]&&(i=e(t[r]))&&(n&&(n+=" "),n+=i)}else for(i in t)t[i]&&(n&&(n+=" "),n+=i);return n}(e))&&(i&&(i+=" "),i+=t);return i}])},5822,(e,t,r)=>{"use strict";function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function n(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}}function o(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}Object.defineProperty(r,"__esModule",{value:!0});r.Event=function(){var e;function t(){var e,r;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");e="subscribers",r=new Set,(e=o(e))in this?Object.defineProperty(this,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[e]=r}return e=[{key:"onSubscribe",get:function(){return this._onSubscribe||(this._onSubscribe=new t),this._onSubscribe}},{key:"onUnsubscribe",get:function(){return this._onUnsubscribe||(this._onUnsubscribe=new t),this._onUnsubscribe}},{key:"subscribe",value:function(e){var t,r=this;return this.subscribers.add(e),null==(t=this._onSubscribe)||t.emit(e),function(){return r.unsubscribe(e)}}},{key:"unsubscribe",value:function(e){var t;this.subscribers.delete(e),null==(t=this._onUnsubscribe)||t.emit(e)}},{key:"clear",value:function(){if(this._onUnsubscribe){var e,t=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=n(e))){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw s}}}}(this.subscribers);try{for(t.s();!(e=t.n()).done;){var r=e.value;this._onUnsubscribe.emit(r)}}catch(e){t.e(e)}finally{t.f()}}this.subscribers.clear()}},{key:"emit",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.subscribers.forEach(function(e){return e.apply(void 0,t)})}},{key:"emitAsync",value:function(){for(var e,t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];return Promise.all(((function(e){if(Array.isArray(e))return i(e)})(e=this.subscribers)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map(function(e){return e.apply(void 0,r)}))}}],function(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,o(i.key),i)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}()},17747,(e,t,r)=>{"use strict";t.exports=e.r(5822)},11742,e=>{"use strict";let t;var r=e.i(71645);let i=e=>{let t,r=new Set,i=(e,i)=>{let n="function"==typeof e?e(t):e;if(!Object.is(n,t)){let e=t;t=(null!=i?i:"object"!=typeof n||null===n)?n:Object.assign({},t,n),r.forEach(r=>r(t,e))}},n=()=>t,o={setState:i,getState:n,getInitialState:()=>s,subscribe:e=>(r.add(e),()=>r.delete(e))},s=t=e(i,n,o);return o},n=e=>{let t=e?i(e):i,n=e=>(function(e,t=e=>e){let i=r.default.useSyncExternalStore(e.subscribe,r.default.useCallback(()=>t(e.getState()),[e,t]),r.default.useCallback(()=>t(e.getInitialState()),[e,t]));return r.default.useDebugValue(i),i})(t,e);return Object.assign(n,t),n},o=(t=e=>({hp:100,maxHp:100,attack:0,defense:0,log:[],currentTurn:0,currentFloor:1,gameStatus:"PLAYING",level:1,currentXp:0,nextLevelXp:100,totalXp:0,lastHitTime:0,triggerHit:()=>e({lastHitTime:Date.now()}),nextFloor:()=>e(e=>({currentFloor:e.currentFloor+1})),setFloor:t=>e({currentFloor:t}),setGameStatus:t=>e({gameStatus:t}),setHp:t=>e({hp:t}),setMaxHp:t=>e({maxHp:t}),setStats:({attack:t,defense:r})=>e({attack:t,defense:r}),addLog:(t,r="white")=>e(e=>({log:[...e.log,{text:t,color:r,turn:e.currentTurn}].slice(-50)})),clearLog:()=>e({log:[]}),incrementTurn:()=>e(e=>({currentTurn:e.currentTurn+1})),setExperience:t=>e({level:t.level,currentXp:t.currentXp,nextLevelXp:t.nextLevelXp,totalXp:t.totalXp})}))?n(t):n;e.s(["useGameStore",0,o],11742)},15089,47830,42412,55409,77757,69268,34147,36352,15959,90001,40253,e=>{"use strict";var t,r,i,n=e.i(17747);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function s(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e,t,r){return(t=s(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r=Symbol.iterator;var l=function(){var e;function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!(this instanceof t))throw TypeError("Cannot call a class as a function");a(this,"_version",0),a(this,"onEntityAdded",new n.Event),a(this,"onEntityRemoved",new n.Event),a(this,"entityPositions",new Map),this._entities=e,this.add=this.add.bind(this),this.remove=this.remove.bind(this);for(var r=0;r<e.length;r++)this.entityPositions.set(e[r],r)}return e=[{key:"version",get:function(){return this._version}},{key:"entities",get:function(){return this._entities}},{key:r,value:function(){var e=this,t=this._entities.length,r={value:void 0,done:!1};return{next:function(){return r.value=e._entities[--t],r.done=t<0,r}}}},{key:"size",get:function(){return this.entities.length}},{key:"first",get:function(){return this.entities[0]}},{key:"has",value:function(e){return this.entityPositions.has(e)}},{key:"add",value:function(e){return e&&!this.has(e)&&(this.entities.push(e),this.entityPositions.set(e,this.entities.length-1),this._version++,this.onEntityAdded.emit(e)),e}},{key:"remove",value:function(e){if(this.has(e)){this.onEntityRemoved.emit(e);var t=this.entityPositions.get(e);this.entityPositions.delete(e);var r=this.entities[this.entities.length-1];r!==e&&(this.entities[t]=r,this.entityPositions.set(r,t)),this.entities.pop(),this._version++}return e}},{key:"clear",value:function(){var e,t=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return o(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,void 0)}}(e))){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw s}}}}(this);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.remove(r)}}catch(e){t.e(e)}finally{t.f()}}}],function(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,s(i.key),i)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(),c=new WeakMap,u=0,h=function(e){var t=c.get(e);return void 0!==t?t:(c.set(e,u),u++)};function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function f(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,t)}}function p(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(this,arguments)}function y(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=f(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function x(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function b(e,t,r){return(t=x(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach(function(t){b(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function S(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,x(i.key),i)}}function T(e,t,r){return t&&S(e.prototype,t),r&&S(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e,t){return(j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,i=m(e);r=t?Reflect.construct(i,arguments,m(this).constructor):i.apply(this,arguments);if(r&&("object"==typeof r||"function"==typeof r))return r;if(void 0!==r)throw TypeError("Derived constructors may only return object or undefined");return O(this)}}var k=function(e){E(r,e);var t=M(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return _(this,r),b(O(e=t.call(this,i)),"queries",new Set),b(O(e),"entityToId",new Map),b(O(e),"idToEntity",new Map),b(O(e),"nextId",0),e.onEntityAdded.subscribe(function(t){e.reindex(t)}),e.onEntityRemoved.subscribe(function(t){if(e.queries.forEach(function(e){return e.remove(t)}),e.entityToId.has(t)){var r=e.entityToId.get(t);e.idToEntity.delete(r),e.entityToId.delete(t)}}),e}return T(r,[{key:"update",value:function(e){function t(t,r,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t,r){if("function"==typeof t){var i=t(e);i&&Object.assign(e,i)}else"string"==typeof t?e[t]=r:t&&Object.assign(e,t);return this.reindex(e),e})},{key:"addComponent",value:function(e,t,r){void 0===e[t]&&(e[t]=r,this.reindex(e))}},{key:"removeComponent",value:function(e,t){if(void 0!==e[t]){if(this.has(e)){var r=w({},e);delete r[t],this.reindex(e,r)}delete e[t]}}},{key:"query",value:function(e){var t,r,i={with:A((t=e).with),without:A(t.without),predicates:p(new Set(t.predicates))},n=R(i),o=y(this.queries);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(s.key===n)return s}}catch(e){o.e(e)}finally{o.f()}var a=new N(this,i);return this.queries.add(a),a}},{key:"with",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.query({with:t,without:[],predicates:[]})}},{key:"without",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.query({with:[],without:t,predicates:[]})}},{key:"where",value:function(e){return this.query({with:[],without:[],predicates:[e]})}},{key:"reindex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(this.has(e)){var r,i=y(this.queries);try{for(i.s();!(r=i.n()).done;)r.value.evaluate(e,t)}catch(e){i.e(e)}finally{i.f()}}}},{key:"id",value:function(e){if(this.has(e)){if(!this.entityToId.has(e)){var t=this.nextId++;this.entityToId.set(e,t),this.idToEntity.set(t,e)}return this.entityToId.get(e)}}},{key:"entity",value:function(e){return this.idToEntity.get(e)}}]),r}(l);i=Symbol.iterator;var N=function(e){E(r,e);var t=M(r);function r(e,i){var n;return _(this,r),b(O(n=t.call(this)),"_isConnected",!1),n.world=e,n.config=i,n.key=R(i),n.onEntityAdded.onSubscribe.subscribe(function(){return n.connect()}),n.onEntityRemoved.onSubscribe.subscribe(function(){return n.connect()}),n}return T(r,[{key:"isConnected",get:function(){return this._isConnected}},{key:"entities",get:function(){return this._isConnected||this.connect(),g(m(r.prototype),"entities",this)}},{key:i,value:function(){return this._isConnected||this.connect(),g(m(r.prototype),Symbol.iterator,this).call(this)}},{key:"connect",value:function(){if(!this._isConnected){this._isConnected=!0;var e,t=y(this.world);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.evaluate(r)}}catch(e){t.e(e)}finally{t.f()}}return this}},{key:"disconnect",value:function(){return this._isConnected=!1,this}},{key:"with",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.world.query(w(w({},this.config),{},{with:[].concat(p(this.config.with),t)}))}},{key:"without",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.world.query(w(w({},this.config),{},{without:[].concat(p(this.config.without),t)}))}},{key:"where",value:function(e){return this.world.query(w(w({},this.config),{},{predicates:[].concat(p(this.config.predicates),[e])}))}},{key:"want",value:function(e){return this.config.with.every(function(t){return void 0!==e[t]})&&this.config.without.every(function(t){return void 0===e[t]})&&this.config.predicates.every(function(t){return t(e)})}},{key:"evaluate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(this.isConnected){var r=this.want(t),i=this.has(e);r&&!i?this.add(e):!r&&i&&this.remove(e)}}}]),r}(l),A=function(e){return p(new Set(e.sort().filter(function(e){return!!e&&""!==e})))};function R(e){return"".concat(e.with.join(","),":").concat(e.without.join(","),":").concat(e.predicates.map(function(e){return h(e)}).join(","))}var I=[];function P(e){I.push(e)}function C(){I.length=0}P.clear=C,P.flush=function(){I.forEach(function(e){return e()}),C()};let L=new k;e.s(["world",0,L],47830);class D{constructor(){this._seed=0,this._s0=0,this._s1=0,this._s2=0,this._c=0}getSeed(){return this._seed}setSeed(e){return e=e<1?1/e:e,this._seed=e,this._s0=(e>>>0)*23283064365386963e-26,e=69069*e+1>>>0,this._s1=23283064365386963e-26*e,e=69069*e+1>>>0,this._s2=23283064365386963e-26*e,this._c=1,this}getUniform(){let e=2091639*this._s0+23283064365386963e-26*this._c;return this._s0=this._s1,this._s1=this._s2,this._c=0|e,this._s2=e-this._c,this._s2}getUniformInt(e,t){let r=Math.max(e,t),i=Math.min(e,t);return Math.floor(this.getUniform()*(r-i+1))+i}getNormal(e=0,t=1){let r,i,n;do n=(r=2*this.getUniform()-1)*r+(i=2*this.getUniform()-1)*i;while(n>1||0==n)return e+r*Math.sqrt(-2*Math.log(n)/n)*t}getPercentage(){return 1+Math.floor(100*this.getUniform())}getItem(e){return e.length?e[Math.floor(this.getUniform()*e.length)]:null}shuffle(e){let t=[],r=e.slice();for(;r.length;){let e=r.indexOf(this.getItem(r));t.push(r.splice(e,1)[0])}return t}getWeightedValue(e){let t=0;for(let r in e)t+=e[r];let r=this.getUniform()*t,i,n=0;for(i in e)if(r<(n+=e[i]))break;return i}getState(){return[this._s0,this._s1,this._s2,this._c]}setState(e){return this._s0=e[0],this._s1=e[1],this._s2=e[2],this._c=e[3],this}clone(){return new D().setState(this.getState())}}let G=new D().setSeed(Date.now());class H{getContainer(){return null}setOptions(e){this._options=e}}class X extends H{constructor(){super(),this._ctx=document.createElement("canvas").getContext("2d")}schedule(e){requestAnimationFrame(e)}getContainer(){return this._ctx.canvas}setOptions(e){super.setOptions(e);let t=e.fontStyle?`${e.fontStyle} `:"",r=`${t} ${e.fontSize}px ${e.fontFamily}`;this._ctx.font=r,this._updateSize(),this._ctx.font=r,this._ctx.textAlign="center",this._ctx.textBaseline="middle"}clear(){let e=this._ctx.globalCompositeOperation;this._ctx.globalCompositeOperation="copy",this._ctx.fillStyle=this._options.bg,this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height),this._ctx.globalCompositeOperation=e}eventToPosition(e,t){let r=this._ctx.canvas,i=r.getBoundingClientRect();return(e-=i.left,t-=i.top,e*=r.width/i.width,t*=r.height/i.height,e<0||t<0||e>=r.width||t>=r.height)?[-1,-1]:this._normalizedEventToPosition(e,t)}}function F(e,t){return(e%t+t)%t}function q(e,t=0,r=1){return e<t?t:e>r?r:e}function U(e){return e.charAt(0).toUpperCase()+e.substring(1)}function z(e,...t){let r=z.map;return e.replace(/%(?:([a-z]+)|(?:{([^}]+)}))/gi,function(i,n,o,s){if("%"==e.charAt(s-1))return i.substring(1);if(!t.length)return i;let a=t[0],l=(n||o).split(","),c=l.shift()||"",u=r[c.toLowerCase()];if(!u)return i;let h=(a=t.shift())[u].apply(a,l),d=c.charAt(0);return d!=d.toLowerCase()&&(h=U(h)),h})}z.map={s:"toString"},e.s(["capitalize",()=>U,"clamp",()=>q,"format",()=>z,"mod",()=>F],17628);class W extends X{constructor(){super(),this._spacingX=0,this._spacingY=0,this._hexSize=0}draw(e,t){let[r,i,n,o,s]=e,a=[(r+1)*this._spacingX,i*this._spacingY+this._hexSize];if(this._options.transpose&&a.reverse(),t&&(this._ctx.fillStyle=s,this._fill(a[0],a[1])),!n)return;this._ctx.fillStyle=o;let l=[].concat(n);for(let e=0;e<l.length;e++)this._ctx.fillText(l[e],a[0],Math.ceil(a[1]))}computeSize(e,t){return this._options.transpose&&(e+=t,t=e-t,e-=t),[Math.floor(e/this._spacingX)-1,Math.floor((t-2*this._hexSize)/this._spacingY+1)]}computeFontSize(e,t){this._options.transpose&&(e+=t,t=e-t,e-=t);let r=Math.min(2*e/((this._options.width+1)*Math.sqrt(3))-1,t/(2+1.5*(this._options.height-1))),i=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;let n=Math.ceil(this._ctx.measureText("W").width);return this._ctx.font=i,Math.ceil(2*(r=Math.floor(r)+1)/(this._options.spacing*(1+n/100/Math.sqrt(3))))-1}_normalizedEventToPosition(e,t){let r;this._options.transpose?(e+=t,t=e-t,e-=t,r=this._ctx.canvas.width):r=this._ctx.canvas.height;let i=r/this._options.height;return F(t=Math.floor(t/i),2)?(e-=this._spacingX,e=1+2*Math.floor(e/(2*this._spacingX))):e=2*Math.floor(e/(2*this._spacingX)),[e,t]}_fill(e,t){let r=this._hexSize,i=this._options.border,n=this._ctx;n.beginPath(),this._options.transpose?(n.moveTo(e-r+i,t),n.lineTo(e-r/2+i,t+this._spacingX-i),n.lineTo(e+r/2-i,t+this._spacingX-i),n.lineTo(e+r-i,t),n.lineTo(e+r/2-i,t-this._spacingX+i),n.lineTo(e-r/2+i,t-this._spacingX+i),n.lineTo(e-r+i,t)):(n.moveTo(e,t-r+i),n.lineTo(e+this._spacingX-i,t-r/2+i),n.lineTo(e+this._spacingX-i,t+r/2-i),n.lineTo(e,t+r-i),n.lineTo(e-this._spacingX+i,t+r/2-i),n.lineTo(e-this._spacingX+i,t-r/2+i),n.lineTo(e,t-r+i)),n.fill()}_updateSize(){let e,t,r=this._options,i=Math.ceil(this._ctx.measureText("W").width);this._hexSize=Math.floor(r.spacing*(r.fontSize+i/Math.sqrt(3))/2),this._spacingX=this._hexSize*Math.sqrt(3)/2,this._spacingY=1.5*this._hexSize,r.transpose?(e="height",t="width"):(e="width",t="height"),this._ctx.canvas[e]=Math.ceil((r.width+1)*this._spacingX),this._ctx.canvas[t]=Math.ceil((r.height-1)*this._spacingY+2*this._hexSize)}}class $ extends X{constructor(){super(),this._spacingX=0,this._spacingY=0,this._canvasCache={}}setOptions(e){super.setOptions(e),this._canvasCache={}}draw(e,t){$.cache?this._drawWithCache(e):this._drawNoCache(e,t)}_drawWithCache(e){let t,[r,i,n,o,s]=e,a=""+n+o+s;if(a in this._canvasCache)t=this._canvasCache[a];else{let e=this._options.border,r=(t=document.createElement("canvas")).getContext("2d");if(t.width=this._spacingX,t.height=this._spacingY,r.fillStyle=s,r.fillRect(e,e,t.width-e,t.height-e),n){r.fillStyle=o,r.font=this._ctx.font,r.textAlign="center",r.textBaseline="middle";let e=[].concat(n);for(let t=0;t<e.length;t++)r.fillText(e[t],this._spacingX/2,Math.ceil(this._spacingY/2))}this._canvasCache[a]=t}this._ctx.drawImage(t,r*this._spacingX,i*this._spacingY)}_drawNoCache(e,t){let[r,i,n,o,s]=e;if(t){let e=this._options.border;this._ctx.fillStyle=s,this._ctx.fillRect(r*this._spacingX+e,i*this._spacingY+e,this._spacingX-e,this._spacingY-e)}if(!n)return;this._ctx.fillStyle=o;let a=[].concat(n);for(let e=0;e<a.length;e++)this._ctx.fillText(a[e],(r+.5)*this._spacingX,Math.ceil((i+.5)*this._spacingY))}computeSize(e,t){return[Math.floor(e/this._spacingX),Math.floor(t/this._spacingY)]}computeFontSize(e,t){let r=Math.floor(e/this._options.width),i=Math.floor(t/this._options.height),n=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;let o=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=n;let s=o/100*i/r;return s>1&&(i=Math.floor(i/s)),Math.floor(i/this._options.spacing)}_normalizedEventToPosition(e,t){return[Math.floor(e/this._spacingX),Math.floor(t/this._spacingY)]}_updateSize(){let e=this._options,t=Math.ceil(this._ctx.measureText("W").width);this._spacingX=Math.ceil(e.spacing*t),this._spacingY=Math.ceil(e.spacing*e.fontSize),e.forceSquareRatio&&(this._spacingX=this._spacingY=Math.max(this._spacingX,this._spacingY)),this._ctx.canvas.width=e.width*this._spacingX,this._ctx.canvas.height=e.height*this._spacingY}}$.cache=!1;class B extends X{constructor(){super(),this._colorCanvas=document.createElement("canvas")}draw(e,t){let[r,i,n,o,s]=e,a=this._options.tileWidth,l=this._options.tileHeight;if(t&&(this._options.tileColorize?this._ctx.clearRect(r*a,i*l,a,l):(this._ctx.fillStyle=s,this._ctx.fillRect(r*a,i*l,a,l))),!n)return;let c=[].concat(n),u=[].concat(o),h=[].concat(s);for(let e=0;e<c.length;e++){let t=this._options.tileMap[c[e]];if(!t)throw Error(`Char "${c[e]}" not found in tileMap`);if(this._options.tileColorize){let n=this._colorCanvas,o=n.getContext("2d");o.globalCompositeOperation="source-over",o.clearRect(0,0,a,l);let s=u[e],c=h[e];o.drawImage(this._options.tileSet,t[0],t[1],a,l,0,0,a,l),"transparent"!=s&&(o.fillStyle=s,o.globalCompositeOperation="source-atop",o.fillRect(0,0,a,l)),"transparent"!=c&&(o.fillStyle=c,o.globalCompositeOperation="destination-over",o.fillRect(0,0,a,l)),this._ctx.drawImage(n,r*a,i*l,a,l)}else this._ctx.drawImage(this._options.tileSet,t[0],t[1],a,l,r*a,i*l,a,l)}}computeSize(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}computeFontSize(){throw Error("Tile backend does not understand font size")}_normalizedEventToPosition(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}_updateSize(){let e=this._options;this._ctx.canvas.width=e.width*e.tileWidth,this._ctx.canvas.height=e.height*e.tileHeight,this._colorCanvas.width=e.tileWidth,this._colorCanvas.height=e.tileHeight}}function Y(e){let t,r;if(e in ea)t=ea[e];else{if("#"==e.charAt(0)){let r=(e.match(/[0-9a-f]/gi)||[]).map(e=>parseInt(e,16));if(3==r.length)t=r.map(e=>17*e);else{for(let e=0;e<3;e++)r[e+1]+=16*r[e],r.splice(e,1);t=r}}else t=(r=e.match(/rgb\(([0-9, ]+)\)/i))?r[1].split(/\s*,\s*/).map(e=>parseInt(e)):[0,0,0];ea[e]=t}return t.slice()}function V(e,...t){let r=e.slice();for(let e=0;e<3;e++)for(let i=0;i<t.length;i++)r[e]+=t[i][e];return r}function K(e,...t){for(let r=0;r<3;r++)for(let i=0;i<t.length;i++)e[r]+=t[i][r];return e}function Q(e,...t){let r=e.slice();for(let e=0;e<3;e++){for(let i=0;i<t.length;i++)r[e]*=t[i][e]/255;r[e]=Math.round(r[e])}return r}function Z(e,...t){for(let r=0;r<3;r++){for(let i=0;i<t.length;i++)e[r]*=t[i][r]/255;e[r]=Math.round(e[r])}return e}function J(e,t,r=.5){let i=e.slice();for(let n=0;n<3;n++)i[n]=Math.round(i[n]+r*(t[n]-e[n]));return i}function ee(e,t,r=.5){let i=er(e),n=er(t);for(let e=0;e<3;e++)i[e]+=r*(n[e]-i[e]);return en(i)}function et(e,t){t instanceof Array||(t=Math.round(G.getNormal(0,t)));let r=e.slice();for(let e=0;e<3;e++)r[e]+=t instanceof Array?Math.round(G.getNormal(0,t[e])):t;return r}function er(e){let t=e[0]/255,r=e[1]/255,i=e[2]/255,n=Math.max(t,r,i),o=Math.min(t,r,i),s=0,a,l=(n+o)/2;if(n==o)a=0;else{let e=n-o;switch(a=l>.5?e/(2-n-o):e/(n+o),n){case t:s=(r-i)/e+6*(r<i);break;case r:s=(i-t)/e+2;break;case i:s=(t-r)/e+4}s/=6}return[s,a,l]}function ei(e,t,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function en(e){let t=e[2];if(0==e[1])return[t=Math.round(255*t),t,t];{let r=e[1],i=t<.5?t*(1+r):t+r-t*r,n=2*t-i;return[Math.round(255*ei(n,i,e[0]+1/3)),Math.round(255*ei(n,i,e[0])),Math.round(255*ei(n,i,e[0]-1/3))]}}function eo(e){let t=e.map(e=>q(e,0,255));return`rgb(${t.join(",")})`}function es(e){let t=e.map(e=>q(e,0,255).toString(16).padStart(2,"0"));return`#${t.join("")}`}let ea={black:[0,0,0],navy:[0,0,128],darkblue:[0,0,139],mediumblue:[0,0,205],blue:[0,0,255],darkgreen:[0,100,0],green:[0,128,0],teal:[0,128,128],darkcyan:[0,139,139],deepskyblue:[0,191,255],darkturquoise:[0,206,209],mediumspringgreen:[0,250,154],lime:[0,255,0],springgreen:[0,255,127],aqua:[0,255,255],cyan:[0,255,255],midnightblue:[25,25,112],dodgerblue:[30,144,255],forestgreen:[34,139,34],seagreen:[46,139,87],darkslategray:[47,79,79],darkslategrey:[47,79,79],limegreen:[50,205,50],mediumseagreen:[60,179,113],turquoise:[64,224,208],royalblue:[65,105,225],steelblue:[70,130,180],darkslateblue:[72,61,139],mediumturquoise:[72,209,204],indigo:[75,0,130],darkolivegreen:[85,107,47],cadetblue:[95,158,160],cornflowerblue:[100,149,237],mediumaquamarine:[102,205,170],dimgray:[105,105,105],dimgrey:[105,105,105],slateblue:[106,90,205],olivedrab:[107,142,35],slategray:[112,128,144],slategrey:[112,128,144],lightslategray:[119,136,153],lightslategrey:[119,136,153],mediumslateblue:[123,104,238],lawngreen:[124,252,0],chartreuse:[127,255,0],aquamarine:[127,255,212],maroon:[128,0,0],purple:[128,0,128],olive:[128,128,0],gray:[128,128,128],grey:[128,128,128],skyblue:[135,206,235],lightskyblue:[135,206,250],blueviolet:[138,43,226],darkred:[139,0,0],darkmagenta:[139,0,139],saddlebrown:[139,69,19],darkseagreen:[143,188,143],lightgreen:[144,238,144],mediumpurple:[147,112,216],darkviolet:[148,0,211],palegreen:[152,251,152],darkorchid:[153,50,204],yellowgreen:[154,205,50],sienna:[160,82,45],brown:[165,42,42],darkgray:[169,169,169],darkgrey:[169,169,169],lightblue:[173,216,230],greenyellow:[173,255,47],paleturquoise:[175,238,238],lightsteelblue:[176,196,222],powderblue:[176,224,230],firebrick:[178,34,34],darkgoldenrod:[184,134,11],mediumorchid:[186,85,211],rosybrown:[188,143,143],darkkhaki:[189,183,107],silver:[192,192,192],mediumvioletred:[199,21,133],indianred:[205,92,92],peru:[205,133,63],chocolate:[210,105,30],tan:[210,180,140],lightgray:[211,211,211],lightgrey:[211,211,211],palevioletred:[216,112,147],thistle:[216,191,216],orchid:[218,112,214],goldenrod:[218,165,32],crimson:[220,20,60],gainsboro:[220,220,220],plum:[221,160,221],burlywood:[222,184,135],lightcyan:[224,255,255],lavender:[230,230,250],darksalmon:[233,150,122],violet:[238,130,238],palegoldenrod:[238,232,170],lightcoral:[240,128,128],khaki:[240,230,140],aliceblue:[240,248,255],honeydew:[240,255,240],azure:[240,255,255],sandybrown:[244,164,96],wheat:[245,222,179],beige:[245,245,220],whitesmoke:[245,245,245],mintcream:[245,255,250],ghostwhite:[248,248,255],salmon:[250,128,114],antiquewhite:[250,235,215],linen:[250,240,230],lightgoldenrodyellow:[250,250,210],oldlace:[253,245,230],red:[255,0,0],fuchsia:[255,0,255],magenta:[255,0,255],deeppink:[255,20,147],orangered:[255,69,0],tomato:[255,99,71],hotpink:[255,105,180],coral:[255,127,80],darkorange:[255,140,0],lightsalmon:[255,160,122],orange:[255,165,0],lightpink:[255,182,193],pink:[255,192,203],gold:[255,215,0],peachpuff:[255,218,185],navajowhite:[255,222,173],moccasin:[255,228,181],bisque:[255,228,196],mistyrose:[255,228,225],blanchedalmond:[255,235,205],papayawhip:[255,239,213],lavenderblush:[255,240,245],seashell:[255,245,238],cornsilk:[255,248,220],lemonchiffon:[255,250,205],floralwhite:[255,250,240],snow:[255,250,250],yellow:[255,255,0],lightyellow:[255,255,224],ivory:[255,255,240],white:[255,255,255]};e.s(["add",()=>V,"add_",()=>K,"fromString",()=>Y,"hsl2rgb",()=>en,"interpolate",()=>J,"interpolateHSL",()=>ee,"lerp",0,J,"lerpHSL",0,ee,"multiply",()=>Q,"multiply_",()=>Z,"randomize",()=>et,"rgb2hsl",()=>er,"toHex",()=>es,"toRGB",()=>eo],84958);class el extends H{constructor(){super(),this._uniforms={};try{this._gl=this._initWebGL()}catch(e){"string"==typeof e?alert(e):e instanceof Error&&alert(e.message)}}static isSupported(){return!!document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0})}schedule(e){requestAnimationFrame(e)}getContainer(){return this._gl.canvas}setOptions(e){super.setOptions(e),this._updateSize();let t=this._options.tileSet;t&&"complete"in t&&!t.complete?t.addEventListener("load",()=>this._updateTexture(t)):this._updateTexture(t)}draw(e,t){let r=this._gl,i=this._options,[n,o,s,a,l]=e,c=r.canvas.height-(o+1)*i.tileHeight;if(r.scissor(n*i.tileWidth,c,i.tileWidth,i.tileHeight),t&&(i.tileColorize?r.clearColor(0,0,0,0):r.clearColor(...ef(l)),r.clear(r.COLOR_BUFFER_BIT)),!s)return;let u=[].concat(s),h=[].concat(l),d=[].concat(a);r.uniform2fv(this._uniforms.targetPosRel,[n,o]);for(let e=0;e<u.length;e++){let t=this._options.tileMap[u[e]];if(!t)throw Error(`Char "${u[e]}" not found in tileMap`);r.uniform1f(this._uniforms.colorize,+!!i.tileColorize),r.uniform2fv(this._uniforms.tilesetPosAbs,t),i.tileColorize&&(r.uniform4fv(this._uniforms.tint,ef(d[e])),r.uniform4fv(this._uniforms.bg,ef(h[e]))),r.drawArrays(r.TRIANGLE_STRIP,0,4)}}clear(){let e=this._gl;e.clearColor(...ef(this._options.bg)),e.scissor(0,0,e.canvas.width,e.canvas.height),e.clear(e.COLOR_BUFFER_BIT)}computeSize(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}computeFontSize(){throw Error("Tile backend does not understand font size")}eventToPosition(e,t){let r=this._gl.canvas,i=r.getBoundingClientRect();return(e-=i.left,t-=i.top,e*=r.width/i.width,t*=r.height/i.height,e<0||t<0||e>=r.width||t>=r.height)?[-1,-1]:this._normalizedEventToPosition(e,t)}_initWebGL(){var e;let t,r,i=document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0});window.gl=i;let n=function(e,t,r){let i=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(i,t),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw Error(e.getShaderInfoLog(i)||"");let n=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw Error(e.getShaderInfoLog(n)||"");let o=e.createProgram();if(e.attachShader(o,i),e.attachShader(o,n),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))throw Error(e.getProgramInfoLog(o)||"");return o}(i,eu,eh);return i.useProgram(n),e=i,t=new Float32Array([0,0,1,0,0,1,1,1]),r=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0),ec.forEach(e=>this._uniforms[e]=i.getUniformLocation(n,e)),this._program=n,i.enable(i.BLEND),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA),i.enable(i.SCISSOR_TEST),i}_normalizedEventToPosition(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}_updateSize(){let e=this._gl,t=this._options,r=[t.width*t.tileWidth,t.height*t.tileHeight];e.canvas.width=r[0],e.canvas.height=r[1],e.viewport(0,0,r[0],r[1]),e.uniform2fv(this._uniforms.tileSize,[t.tileWidth,t.tileHeight]),e.uniform2fv(this._uniforms.targetSize,r)}_updateTexture(e){var t,r;let i;t=this._gl,r=e,i=t.createTexture(),t.bindTexture(t.TEXTURE_2D,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)}}let ec=["targetPosRel","tilesetPosAbs","tileSize","targetSize","colorize","bg","tint"],eu=`
#version 300 es

in vec2 tilePosRel;
out vec2 tilesetPosPx;

uniform vec2 tilesetPosAbs;
uniform vec2 tileSize;
uniform vec2 targetSize;
uniform vec2 targetPosRel;

void main() {
	vec2 targetPosPx = (targetPosRel + tilePosRel) * tileSize;
	vec2 targetPosNdc = ((targetPosPx / targetSize)-0.5)*2.0;
	targetPosNdc.y *= -1.0;

	gl_Position = vec4(targetPosNdc, 0.0, 1.0);
	tilesetPosPx = tilesetPosAbs + tilePosRel * tileSize;
}`.trim(),eh=`
#version 300 es
precision highp float;

in vec2 tilesetPosPx;
out vec4 fragColor;
uniform sampler2D image;
uniform bool colorize;
uniform vec4 bg;
uniform vec4 tint;

void main() {
	fragColor = vec4(0, 0, 0, 1);

	vec4 texel = texelFetch(image, ivec2(tilesetPosPx), 0);

	if (colorize) {
		texel.rgb = tint.a * tint.rgb + (1.0-tint.a) * texel.rgb;
		fragColor.rgb = texel.a*texel.rgb + (1.0-texel.a)*bg.rgb;
		fragColor.a = texel.a + (1.0-texel.a)*bg.a;
	} else {
		fragColor = texel;
	}
}`.trim(),ed={};function ef(e){if(!(e in ed)){let t;if("transparent"==e)t=[0,0,0,0];else if(e.indexOf("rgba")>-1){t=(e.match(/[\d.]+/g)||[]).map(Number);for(let e=0;e<3;e++)t[e]=t[e]/255}else(t=Y(e).map(e=>e/255)).push(1);ed[e]=t}return ed[e]}var ep=e.i(47167);function em(e){let t=Y(e);return 36*Math.floor(.0234375*t[0])+6*Math.floor(.0234375*t[1])+ +Math.floor(.0234375*t[2])+16}class eg extends H{constructor(){super(),this._offset=[0,0],this._cursor=[-1,-1],this._lastColor=""}schedule(e){setTimeout(e,1e3/60)}setOptions(e){super.setOptions(e);let t=[e.width,e.height],r=this.computeSize();this._offset=r.map((e,r)=>Math.floor((e-t[r])/2))}clear(){var e;ep.default.stdout.write((e=this._options.bg,`\x1b[0;48;5;${em(e)}m\x1b[2J`))}draw(e,t){let[r,i,n,o,s]=e,a=this._offset[0]+r,l=this._offset[1]+i,c=this.computeSize();if(a<0||a>=c[0]||l<0||l>=c[1])return;if((a!==this._cursor[0]||l!==this._cursor[1])&&(ep.default.stdout.write(`\x1b[${l+1};${a+1}H`),this._cursor[0]=a,this._cursor[1]=l),t&&!n&&(n=" "),!n)return;let u=`\x1b[0;38;5;${em(o)};48;5;${em(s)}m`;if(u!==this._lastColor&&(ep.default.stdout.write(u),this._lastColor=u),"	"!=n){let e=[].concat(n);ep.default.stdout.write(e[0])}this._cursor[0]++,this._cursor[0]>=c[0]&&(this._cursor[0]=0,this._cursor[1]++)}computeFontSize(){throw Error("Terminal backend has no notion of font size")}eventToPosition(e,t){return[e,t]}computeSize(){return[ep.default.stdout.columns,ep.default.stdout.rows]}}let ey=/%([bc]){([^}]*)}/g;function ex(e,t){let r={width:0,height:1},i=eb(e,t),n=0;for(let e=0;e<i.length;e++){let t=i[e];switch(t.type){case 0:n+=t.value.length;break;case 1:r.height++,r.width=Math.max(r.width,n),n=0}}return r.width=Math.max(r.width,n),r}function eb(e,t){let r=[],i=0;e.replace(ey,function(t,n,o,s){let a=e.substring(i,s);return a.length&&r.push({type:0,value:a}),r.push({type:"c"==n?2:3,value:o.trim()}),i=s+t.length,""});let n=e.substring(i);return n.length&&r.push({type:0,value:n}),function(e,t){t||(t=1/0);let r=0,i=0,n=-1;for(;r<e.length;){let o=e[r];if(1==o.type&&(i=0,n=-1),0!=o.type){r++;continue}for(;0==i&&" "==o.value.charAt(0);)o.value=o.value.substring(1);let s=o.value.indexOf("\n");if(-1!=s){o.value=ev(e,r,s,!0);let t=o.value.split("");for(;t.length&&" "==t[t.length-1];)t.pop();o.value=t.join("")}if(!o.value.length){e.splice(r,1);continue}if(i+o.value.length>t){let s=-1;for(;;){let e=o.value.indexOf(" ",s+1);if(-1==e||i+e>t)break;s=e}if(-1!=s)o.value=ev(e,r,s,!0);else if(-1!=n){let t=e[n],i=t.value.lastIndexOf(" ");t.value=ev(e,n,i,!0),r=n}else o.value=ev(e,r,t-i,!1)}else i+=o.value.length,-1!=o.value.indexOf(" ")&&(n=r);r++}e.push({type:1});let o=null;for(let t=0;t<e.length;t++){let r=e[t];switch(r.type){case 0:o=r;break;case 1:if(o){let e=o.value.split("");for(;e.length&&" "==e[e.length-1];)e.pop();o.value=e.join("")}o=null}}return e.pop(),e}(r,t)}function ev(e,t,r,i){let n={type:0,value:e[t].value.substring(r+ +!!i)};return e.splice(t+1,0,{type:1},n),e[t].value.substring(0,r)}e.s(["TYPE_BG",0,3,"TYPE_FG",0,2,"TYPE_NEWLINE",0,1,"TYPE_TEXT",0,0,"measure",()=>ex,"tokenize",()=>eb],74283);let ew={4:[[0,-1],[1,0],[0,1],[-1,0]],8:[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]],6:[[-1,-1],[1,-1],[2,0],[1,1],[-1,1],[-2,0]]},e_={hex:W,rect:$,tile:B,"tile-gl":el,term:eg},eS={width:80,height:25,transpose:!1,layout:"rect",fontSize:15,spacing:1,border:0,forceSquareRatio:!1,fontFamily:"monospace",fontStyle:"",fg:"#ccc",bg:"#000",tileWidth:32,tileHeight:32,tileMap:{},tileSet:null,tileColorize:!1};class eT{constructor(e={}){this._data={},this._dirty=!1,this._options={},e=Object.assign({},eS,e),this.setOptions(e),this.DEBUG=this.DEBUG.bind(this),this._tick=this._tick.bind(this),this._backend.schedule(this._tick)}DEBUG(e,t,r){let i=[this._options.bg,this._options.fg];this.draw(e,t,null,null,i[r%i.length])}clear(){this._data={},this._dirty=!0}setOptions(e){if(Object.assign(this._options,e),e.width||e.height||e.fontSize||e.fontFamily||e.spacing||e.layout){if(e.layout){let t=e_[e.layout];this._backend=new t}this._backend.setOptions(this._options),this._dirty=!0}return this}getOptions(){return this._options}getContainer(){return this._backend.getContainer()}computeSize(e,t){return this._backend.computeSize(e,t)}computeFontSize(e,t){return this._backend.computeFontSize(e,t)}computeTileSize(e,t){return[Math.floor(e/this._options.width),Math.floor(t/this._options.height)]}eventToPosition(e){let t,r;return"touches"in e?(t=e.touches[0].clientX,r=e.touches[0].clientY):(t=e.clientX,r=e.clientY),this._backend.eventToPosition(t,r)}draw(e,t,r,i,n){i||(i=this._options.fg),n||(n=this._options.bg);let o=`${e},${t}`;this._data[o]=[e,t,r,i,n],!0!==this._dirty&&(this._dirty||(this._dirty={}),this._dirty[o]=!0)}drawOver(e,t,r,i,n){let o=`${e},${t}`,s=this._data[o];s?(s[2]=r||s[2],s[3]=i||s[3],s[4]=n||s[4]):this.draw(e,t,r,i,n)}drawText(e,t,r,i){let n=null,o=null,s=e,a=t,l=1;i||(i=this._options.width-e);let c=eb(r,i);for(;c.length;){let t=c.shift();switch(t.type){case 0:let r=!1,i=!1,u=!1,h=!1;for(let e=0;e<t.value.length;e++){let l=t.value.charCodeAt(e),c=t.value.charAt(e);if("term"===this._options.layout){let e=l>>8;if(17===e||e>=46&&e<=159||e>=172&&e<=215||l>=43360&&l<=43391){this.draw(s+0,a,c,n,o),this.draw(s+1,a,"	",n,o),s+=2;continue}}u=l>65280&&l<65377||l>65500&&l<65512||l>65518,r=32==c.charCodeAt(0)||12288==c.charCodeAt(0),h&&!u&&!r&&s++,u&&!i&&s++,this.draw(s++,a,c,n,o),i=r,h=u}break;case 2:n=t.value||null;break;case 3:o=t.value||null;break;case 1:s=e,a++,l++}}return l}_tick(){if(this._backend.schedule(this._tick),this._dirty){if(!0===this._dirty)for(let e in this._backend.clear(),this._data)this._draw(e,!1);else for(let e in this._dirty)this._draw(e,!0);this._dirty=!1}}_draw(e,t){let r=this._data[e];r[4]!=this._options.bg&&(t=!0),this._backend.draw(r,t)}}eT.Rect=$,eT.Hex=W,eT.Tile=B,eT.TileGL=el,eT.Term=eg,e.s(["default",()=>eT],42412);class eO{constructor(e,t={}){this._lightPasses=e,this._options=Object.assign({topology:8},t)}_getCircle(e,t,r){let i,n,o,s=[];switch(this._options.topology){case 4:n=1,o=[0,1],i=[ew[8][7],ew[8][1],ew[8][3],ew[8][5]];break;case 6:i=ew[6],n=1,o=[-1,1];break;case 8:i=ew[4],n=2,o=[-1,1];break;default:throw Error("Incorrect topology for FOV computation")}let a=e+o[0]*r,l=t+o[1]*r;for(let e=0;e<i.length;e++)for(let t=0;t<r*n;t++)s.push([a,l]),a+=i[e][0],l+=i[e][1];return s}}let ej=[[-1,0,0,1],[0,-1,1,0],[0,-1,-1,0],[-1,0,0,-1],[1,0,0,-1],[0,1,-1,0],[0,1,1,0],[1,0,0,1]],eE=class extends eO{compute(e,t,r,i){let n,o,s,a,l,c;if(i(e,t,0,1),!this._lightPasses(e,t))return;let u=[];for(let h=1;h<=r;h++){let r=this._getCircle(e,t,h),d=r.length;for(let e=0;e<d;e++)if(n=r[e][0],o=r[e][1],a=[e?2*e-1:2*d-1,2*d],l=[2*e+1,2*d],s=!this._lightPasses(n,o),(c=this._checkVisibility(a,l,s,u))&&i(n,o,h,c),2==u.length&&0==u[0][0]&&u[1][0]==u[1][1])return}}_checkVisibility(e,t,r,i){let n;if(e[0]>t[0])return(this._checkVisibility(e,[e[1],e[1]],r,i)+this._checkVisibility([0,1],t,r,i))/2;let o=0,s=!1;for(;o<i.length;){let t=i[o],r=t[0]*e[1]-e[0]*t[1];if(r>=0){0!=r||o%2||(s=!0);break}o++}let a=i.length,l=!1;for(;a--;){let e=i[a],r=t[0]*e[1]-e[0]*t[1];if(r>=0){0==r&&a%2&&(l=!0);break}}let c=!0;if(o==a&&(s||l)||s&&l&&o+1==a&&a%2?c=!1:o>a&&o%2&&(c=!1),!c)return 0;let u=a-o+1;if(u%2)if(o%2){let e=i[o];n=(t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]),r&&i.splice(o,u,t)}else{let t=i[a];n=(t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]),r&&i.splice(o,u,e)}else{if(!(o%2))return r&&i.splice(o,u,e,t),1;let s=i[o],l=i[a];n=(l[0]*s[1]-s[0]*l[1])/(s[1]*l[1]),r&&i.splice(o,u)}return n/((t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]))}};e.i(17628),e.i(84958),e.i(74283),e.s([],55409);let eM="#1a1a1a";e.s(["BG_COLOR",0,eM,"FONT_SIZE",0,16,"GRID_HEIGHT",0,35,"GRID_WIDTH",0,70,"MAX_INVENTORY_SIZE",0,10],77757);var ek=((t={}).WALL="#",t.FLOOR=".",t);let eN=Array(2450).fill("#");function eA(){eN.fill("#")}function eR(e,t){return e>=0&&e<70&&t>=0&&t<35}function eI(e,t,r){eR(e,t)&&(eN[70*t+e]=r)}function eP(e,t){return eR(e,t)?eN[70*t+e]:null}e.s(["TileType",()=>ek,"getTile",()=>eP,"isInBounds",()=>eR,"mapData",0,eN,"resetMap",()=>eA,"setTile",()=>eI],69268);class eC{visibleCells=new Set;exploredCells=new Set;rotFOV;constructor(){this.rotFOV=new eE((e,t)=>eP(e,t)===ek.FLOOR)}compute(e,t,r){this.visibleCells.clear(),this.rotFOV.compute(e,t,r,(e,t)=>{let r=70*t+e;this.visibleCells.add(r),this.exploredCells.add(r)})}reset(){this.visibleCells.clear(),this.exploredCells.clear()}}let eL=new eC;e.s(["fovSystem",0,eL],34147);var eD=e.i(11742);function eG(e){if(!e.fighter)return;let t=e.fighter.baseAttack||0,r=e.fighter.baseDefense||0,i=e.id||"player";for(let e of Array.from(L.with("equipped","equippable")).filter(e=>e.equipped.ownerId===i))e.equippable.bonuses.attack&&(t+=e.equippable.bonuses.attack),e.equippable.bonuses.defense&&(r+=e.equippable.bonuses.defense);e.fighter.attack=t,e.fighter.defense=r,eD.useGameStore.getState().setStats({attack:t,defense:r})}function eH(e){if(!e.equippable)return{success:!1,message:"Item is not equippable"};let t=L.with("player","fighter"),r=null;for(let e of t){r=e;break}if(!r)return{success:!1,message:"Player not found"};let i=r.id||"player",n=e.equippable.slot;for(let e of Array.from(L.with("equipped","equippable")).filter(e=>e.equipped.ownerId===i&&e.equippable.slot===n))eX(e);L.addComponent(e,"equipped",{ownerId:i});let o=e.name||"Unknown item";return eD.useGameStore.getState().addLog(`You equipped ${o}.`,"green"),eG(r),{success:!0,message:`Equipped ${o}`}}function eX(e){if(!e.equipped)return{success:!1,message:"Item is not equipped"};L.removeComponent(e,"equipped");let t=L.with("player","fighter"),r=null;for(let e of t){r=e;break}r&&eG(r);let i=e.name||"Unknown item";return eD.useGameStore.getState().addLog(`You unequipped ${i}.`,"yellow"),{success:!0,message:`Unequipped ${i}`}}function eF(){let e=L.with("player"),t=null;for(let r of e){t=r.id||"player";break}return t?Array.from(L.with("equipped","equippable")).filter(e=>e.equipped.ownerId===t):[]}e.s(["equipItem",()=>eH,"getPlayerEquipment",()=>eF,"recalculatePlayerStats",()=>eG,"unequipItem",()=>eX],36352);let eq=[],eU=0,ez=null,eW=null,e$=null,eB=0,eY="";function eV(e){ez=e}function eK(e){e$=e}function eQ(e){let t=["*","+"],r=["#fbbf24","#def50bff","#93fc4dff"];eY="LEVEL UP",eB=performance.now()+3e3;for(let i=0;i<28;i++){let n=2*Math.PI*i/28,o=2+1.5*Math.random();eq.push({x:e.x+(.4*Math.random()-.2),y:e.y+(.4*Math.random()-.2),vx:Math.cos(n)*o*.2,vy:-Math.abs(Math.sin(n)*o*.4)-.4,char:t[i%t.length],color:r[i%r.length],lifetimeMs:1500+500*Math.random()})}}function eZ(e){for(let t of eq){let r=Math.round(t.x),i=Math.round(t.y);r<0||i<0||r>=70||i>=35||e.draw(r,i,t.char,t.color,eM)}if(eB>performance.now()&&eY){let t=Math.max(0,Math.floor((70-eY.length)/2)),r=Math.floor(17.5)-1,i=Math.min(70,eY.length+4),n=Math.max(0,Math.floor((70-i)/2));e.drawText(n,r,`%b{#111827} ${" ".repeat(Math.max(0,i-2))} `),e.drawText(t,r,`%c{#facc15}%b{#111827}${eY}`)}}function eJ(e=700,t){if(!ez)return;let r=t??e$;if(!r)return;null!==eW&&(cancelAnimationFrame(eW),eW=null);let i=performance.now(),n=()=>{let t=performance.now();0===eU&&(eU=t);let o=Math.min(50,t-eU);eU=t;for(let e=eq.length-1;e>=0;e-=1){let t=eq[e];t.x+=t.vx*(o/1e3),t.y+=t.vy*(o/1e3),t.lifetimeMs-=o,t.lifetimeMs<=0&&eq.splice(e,1)}r(),eW=t-i<e?requestAnimationFrame(n):null};eW=requestAnimationFrame(n)}function e0(e){return Math.floor(100*Math.pow(e,1.5))}function e1(e){e.experience&&eD.useGameStore.getState().setExperience({level:e.experience.level,currentXp:e.experience.currentXp,nextLevelXp:e.experience.nextLevelXp,totalXp:e.experience.totalXp})}function e2(e,t){if(!e.experience||t<=0)return;let r=Math.floor(t*(.5*eD.useGameStore.getState().currentFloor+1));for(e.experience.currentXp+=r,e.experience.totalXp+=r,eD.useGameStore.getState().addLog(`You gain ${r} XP.`,"yellow");e.experience.currentXp>=e.experience.nextLevelXp;)!function(e){if(e.experience){if(e.experience.level+=1,e.experience.currentXp-=e.experience.nextLevelXp,e.experience.nextLevelXp=e0(e.experience.level),e.fighter){let t=e.fighter.baseAttack??e.fighter.attack,r=e.fighter.baseDefense??e.fighter.defense;e.fighter.maxHp+=10,e.fighter.hp=Math.min(e.fighter.maxHp,e.fighter.hp+10),e.fighter.baseAttack=t+1,e.fighter.baseDefense=r+ +(e.experience.level%2==0),eG(e),eD.useGameStore.getState().setHp(e.fighter.hp),eD.useGameStore.getState().setMaxHp(e.fighter.maxHp)}e.position&&(eQ(e.position),eJ(3e3)),eD.useGameStore.getState().addLog(`Level up! You reached level ${e.experience.level}.`,"purple")}}(e);e1(e)}function e5(e){e.experience={level:1,currentXp:0,nextLevelXp:e0(1),totalXp:0},e1(e)}e.s(["renderParticles",()=>eZ,"setParticleDisplay",()=>eV,"setParticleRenderer",()=>eK,"spawnLevelUpParticles",()=>eQ,"startParticleAnimation",()=>eJ],15959),e.s(["addExperience",()=>e2,"initializeExperience",()=>e5],90001);class e4{grid=new Map;getKey(e,t){return 70*t+e}add(e){if(!e.position)return;let t=this.getKey(e.position.x,e.position.y);this.grid.has(t)||this.grid.set(t,new Set),this.grid.get(t).add(e)}remove(e){if(!e.position){for(let[t,r]of this.grid.entries())if(r.has(e)){r.delete(e),0===r.size&&this.grid.delete(t);break}return}let t=this.getKey(e.position.x,e.position.y),r=this.grid.get(t);r&&(r.delete(e),0===r.size&&this.grid.delete(t))}update(e,t,r){if(!e.position)return;let i=this.getKey(t,r),n=this.grid.get(i);n&&(n.delete(e),0===n.size&&this.grid.delete(i)),this.add(e)}getAt(e,t){let r=this.getKey(e,t),i=this.grid.get(r);return i?Array.from(i):[]}getFirstAt(e,t,r){for(let i of this.getAt(e,t))if(i!==r)return i;return null}hasEntityAt(e,t){let r=this.getKey(e,t),i=this.grid.get(r);return!!i&&i.size>0}clear(){this.grid.clear()}rebuild(e){for(let t of(this.clear(),e))t.position&&this.add(t)}}let e3=new e4;e.s(["spatialGrid",0,e3],40253);let e8="maxime_roguelike_save_v1";function e6(){try{let e=eD.useGameStore.getState(),t={entities:L.entities,map:[...eN],explored:Array.from(eL.exploredCells),stats:{hp:e.hp,maxHp:e.maxHp,attack:e.attack,defense:e.defense,turn:e.currentTurn,floor:e.currentFloor,level:e.level,currentXp:e.currentXp,nextLevelXp:e.nextLevelXp,totalXp:e.totalXp}};return localStorage.setItem(e8,JSON.stringify(t)),e.addLog("Game saved successfully.","yellow"),!0}catch(e){return console.error("Failed to save game:",e),eD.useGameStore.getState().addLog("Failed to save game!","red"),!1}}function e7(){try{let e=localStorage.getItem(e8);if(!e)return!1;let t=JSON.parse(e);if(!function(e){if(!e||"object"!=typeof e||!Array.isArray(e.entities)||!Array.isArray(e.map)||e.map.some(e=>"#"!==e&&"."!==e)||!Array.isArray(e.explored)||e.explored.some(e=>"number"!=typeof e)||!e.stats||"object"!=typeof e.stats)return!1;let t=e.stats;for(let e of["hp","maxHp","attack","defense","turn","floor","level","currentXp","nextLevelXp","totalXp"])if("number"!=typeof t[e])return!1;return!(t.hp<0)&&!(t.maxHp<1)&&!(t.attack<0)&&!(t.defense<0)&&!(t.turn<0)&&!(t.floor<1)&&!(t.level<1)&&!(t.currentXp<0)&&!(t.nextLevelXp<1)&&!(t.totalXp<0)&&!0}(t))return console.error("Save data validation failed"),eD.useGameStore.getState().addLog("Save file is corrupted or invalid!","red"),!1;for(let e of(L.clear(),t.entities))L.add(e);for(let e=0;e<t.map.length;e++)eN[e]=t.map[e];for(let e of(eL.reset(),t.explored))eL.exploredCells.add(e);e3.rebuild(L.entities);let r=eD.useGameStore.getState();r.setHp(t.stats.hp),r.setMaxHp(t.stats.maxHp),r.setStats({attack:t.stats.attack,defense:t.stats.defense}),t.stats.floor&&r.setFloor(t.stats.floor),"number"==typeof t.stats.level&&r.setExperience({level:t.stats.level,currentXp:t.stats.currentXp??0,nextLevelXp:t.stats.nextLevelXp??100,totalXp:t.stats.totalXp??0});let i=L.with("player","position").first;return i&&i.position&&(i.experience||("number"==typeof t.stats.level?i.experience={level:t.stats.level,currentXp:t.stats.currentXp??0,nextLevelXp:t.stats.nextLevelXp??100,totalXp:t.stats.totalXp??0}:e5(i)),eL.compute(i.position.x,i.position.y,8),eG(i),i.experience?"number"!=typeof t.stats.level&&r.setExperience({level:i.experience.level,currentXp:i.experience.currentXp,nextLevelXp:i.experience.nextLevelXp,totalXp:i.experience.totalXp}):"number"!=typeof t.stats.level&&r.setExperience({level:1,currentXp:0,nextLevelXp:100,totalXp:0})),r.addLog("Game loaded successfully.","yellow"),!0}catch(e){return console.error("Failed to load game:",e),eD.useGameStore.getState().addLog("Failed to load game - save file might be corrupted.","red"),!1}}function e9(){localStorage.removeItem(e8)}function te(){return null!==localStorage.getItem(e8)}e.s(["deleteSave",()=>e9,"hasSave",()=>te,"loadGame",()=>e7,"saveGame",()=>e6],15089)},35581,e=>{"use strict";var t=e.i(43476),r=e.i(71645);e.i(55409);var i=e.i(42412),i=i,n=e.i(7670),o=e.i(77757),s=e.i(47830),a=e.i(69268),l=e.i(34147),c=e.i(11742),u=e.i(15959);let h=e=>{e.clear();for(let t=0;t<o.GRID_HEIGHT;t++)for(let r=0;r<o.GRID_WIDTH;r++){let i=t*o.GRID_WIDTH+r,n=l.fovSystem.visibleCells.has(i),s=l.fovSystem.exploredCells.has(i);if(n){let n=a.mapData[i],s=n===a.TileType.WALL?"#":".",l=n===a.TileType.WALL?"#888":"#666";e.draw(r,t,s,l,o.BG_COLOR)}else if(s){let n=a.mapData[i],s=n===a.TileType.WALL?"#":".",l=n===a.TileType.WALL?"#333":"#222";e.draw(r,t,s,l,o.BG_COLOR)}}let t=Array.from(s.world.with("position","renderable"));for(let r of(t.sort((e,t)=>(e.player?2:+!!e.monster)-(t.player?2:+!!t.monster)),t)){if(!r.position||!r.renderable||r.dead)continue;let{x:t,y:i}=r.position,n=i*o.GRID_WIDTH+t;if(l.fovSystem.visibleCells.has(n)){let{char:n,color:s,bg:a}=r.renderable;e.draw(t,i,n,s,a||o.BG_COLOR)}}if((0,u.renderParticles)(e),"GAME_OVER"===c.useGameStore.getState().gameStatus){let t="YOU DIED",r=Math.max(0,Math.floor((o.GRID_WIDTH-t.length)/2)),i=Math.floor(o.GRID_HEIGHT/2);e.drawText(r,i,`%c{#f00}%b{${o.BG_COLOR}}${t}`)}};class d{x;y;w;h;left=null;right=null;room=null;constructor(e,t,r,i){this.x=e,this.y=t,this.w=r,this.h=i}}class f{minRoomSize=6;maxIterations=4;generate(){let e=0;for(;e<10;){(0,a.resetMap)(),e>0&&(0,a.resetMap)();let t=new d(0,0,o.GRID_WIDTH,o.GRID_HEIGHT);this.split(t,0),this.createRooms(t);let r=this.findFirstRoom(t);if(!r){e++;continue}let i={x:Math.floor((r.x1+r.x2)/2),y:Math.floor((r.y1+r.y2)/2)},n=[];if(this.collectRooms(t,n),this.verifyConnectivity(i,n))return{playerStart:i,rooms:n};e++}throw Error("Failed to generate connected dungeon after 10 attempts")}verifyConnectivity(e,t){let r=new Set,i=[e.y*o.GRID_WIDTH+e.x];r.add(e.y*o.GRID_WIDTH+e.x);let n=t.map(e=>({x:Math.floor(e.x+e.w/2),y:Math.floor(e.y+e.h/2)})),s=new Set;for(;i.length>0;){let e=i.pop();s.add(e);let t=e%o.GRID_WIDTH,n=Math.floor(e/o.GRID_WIDTH);for(let e of[{x:t+1,y:n},{x:t-1,y:n},{x:t,y:n+1},{x:t,y:n-1}])if(e.x>=0&&e.x<o.GRID_WIDTH&&e.y>=0&&e.y<o.GRID_HEIGHT){let t=e.y*o.GRID_WIDTH+e.x;r.has(t)||(0,a.getTile)(e.x,e.y)===a.TileType.FLOOR&&(r.add(t),i.push(t))}}for(let e of n){let t=e.y*o.GRID_WIDTH+e.x;if(!s.has(t))return!1}return!0}collectRooms(e,t){e.room&&t.push({x:e.room.x1,y:e.room.y1,w:e.room.x2-e.room.x1,h:e.room.y2-e.room.y1}),e.left&&this.collectRooms(e.left,t),e.right&&this.collectRooms(e.right,t)}split(e,t){if(t>=this.maxIterations)return;let r=Math.random()>.5;e.w>1.25*e.h?r=!1:e.h>1.25*e.w&&(r=!0);let i=(r?e.h:e.w)-this.minRoomSize;if(i<=this.minRoomSize)return;let n=Math.floor(Math.random()*(i-this.minRoomSize)+this.minRoomSize);r?(e.left=new d(e.x,e.y,e.w,n),e.right=new d(e.x,e.y+n,e.w,e.h-n)):(e.left=new d(e.x,e.y,n,e.h),e.right=new d(e.x+n,e.y,e.w-n,e.h)),this.split(e.left,t+1),this.split(e.right,t+1)}createRooms(e){if(e.left||e.right)e.left&&this.createRooms(e.left),e.right&&this.createRooms(e.right),e.left&&e.right&&this.digTunnel(e.left,e.right);else{let t=Math.floor(Math.random()*(e.w-4))+4,r=Math.floor(Math.random()*(e.h-4))+4,i=e.x+Math.floor(Math.random()*(e.w-t-1))+1,n=e.y+Math.floor(Math.random()*(e.h-r-1))+1;e.room={x1:i,y1:n,x2:i+t,y2:n+r};for(let e=n;e<n+r;e++)for(let r=i;r<i+t;r++)(0,a.setTile)(r,e,a.TileType.FLOOR)}}digTunnel(e,t){let r=this.getCenter(e),i=this.getCenter(t);for(let e=Math.min(r.x,i.x);e<=Math.max(r.x,i.x);e++)(0,a.setTile)(e,r.y,a.TileType.FLOOR);for(let e=Math.min(r.y,i.y);e<=Math.max(r.y,i.y);e++)(0,a.setTile)(i.x,e,a.TileType.FLOOR)}getCenter(e){return e.room?{x:Math.floor((e.room.x1+e.room.x2)/2),y:Math.floor((e.room.y1+e.room.y2)/2)}:e.left&&e.right?.5>Math.random()?this.getCenter(e.left):this.getCenter(e.right):e.left?this.getCenter(e.left):e.right?this.getCenter(e.right):{x:Math.floor(e.x+e.w/2),y:Math.floor(e.y+e.h/2)}}findFirstRoom(e){return e.room?e.room:e.left?this.findFirstRoom(e.left):null}}let p={ArrowUp:{dx:0,dy:-1},ArrowDown:{dx:0,dy:1},ArrowLeft:{dx:-1,dy:0},ArrowRight:{dx:1,dy:0},h:{dx:-1,dy:0},j:{dx:0,dy:1},k:{dx:0,dy:-1},l:{dx:1,dy:0},y:{dx:-1,dy:-1},u:{dx:1,dy:-1},b:{dx:-1,dy:1},n:{dx:1,dy:1},1:{dx:-1,dy:1},2:{dx:0,dy:1},3:{dx:1,dy:1},4:{dx:-1,dy:0},6:{dx:1,dy:0},7:{dx:-1,dy:-1},8:{dx:0,dy:-1},9:{dx:1,dy:-1},End:{dx:-1,dy:1},Home:{dx:-1,dy:-1},PageDown:{dx:1,dy:1},PageUp:{dx:1,dy:-1}};var m=e.i(40253);let g=[],y=0;function x(e){g=[...g,e].slice(-50),y+=1}var b=e.i(15089),v=e.i(90001);function w(e){return e.name?e.name:e.player?"Player":e.monster?"Monster":"Entity"}function _(e,t){if(!e.fighter||!t.fighter||t.dead)return;let r=Math.max(0,e.fighter.attack-t.fighter.defense),i=w(e),n=w(t);(r>0?(t.fighter.hp-=r,x(`${i} hit ${n} for ${r}.`),t.player?(c.useGameStore.getState().setHp(t.fighter.hp),c.useGameStore.getState().triggerHit(),c.useGameStore.getState().addLog(`${i} hit you for ${r} damage!`,"red")):c.useGameStore.getState().addLog(`You hit ${n} for ${r} damage!`,"yellow")):(x(`${i} attacks ${n} but does no damage.`),c.useGameStore.getState().addLog(`${i} attacks ${n} but does no damage.`,"gray")),t.fighter.hp<=0)&&(x(`${n} dies!`),t.player?(c.useGameStore.getState().setHp(0),c.useGameStore.getState().addLog("You died!","purple"),c.useGameStore.getState().setGameStatus("GAME_OVER"),(0,b.deleteSave)()):(e.experience&&"number"==typeof t.xpValue&&(0,v.addExperience)(e,t.xpValue),c.useGameStore.getState().addLog(`${n} dies!`,"green")),s.world.addComponent(t,"dead",!0),m.spatialGrid.remove(t),s.world.remove(t))}function S(e){return 0===e?0:e>0?1:-1}function T(){let e=s.world.with("player","position","fighter"),t=null;for(let r of e){t=r;break}if(t&&t.position&&t.fighter)for(let e of s.world.with("monster","position","fighter")){var r,i;if(e.dead||!e.ai||"PASSIVE"===e.ai.type||!e.position)continue;let n=(r=e.position,i=t.position,Math.max(Math.abs(r.x-i.x),Math.abs(r.y-i.y)));if(n>8)continue;if(n<=1){_(e,t);continue}let o=S(t.position.x-e.position.x),s=S(t.position.y-e.position.y);!function(e,t,r){if(!e.position)return;let i=e.position.x,n=e.position.y,o=i+t,s=n+r;if(!(0,a.isInBounds)(o,s))return;let l=(0,a.getTile)(o,s);if(null===l||l===a.TileType.WALL)return;let c=m.spatialGrid.getFirstAt(o,s,e);if(!c){e.position.x=o,e.position.y=s,m.spatialGrid.update(e,i,n);return}c.player&&c.fighter&&e.fighter&&_(e,c)}(e,o,s)}}let O={rat:{id:"rat",name:"Rat Gant",char:"r",color:"#e2a90eff",health:{min:10,max:15},attack:{min:8,max:12},defense:2,aiType:"AGGRESSIVE",xpValue:15,spawnWeight:10},slime_green:{id:"slime_green",name:"Slime Acide",char:"s",color:"#00FF00",health:{min:15,max:20},attack:{min:13,max:18},defense:3,aiType:"AGGRESSIVE",xpValue:20,spawnWeight:5},tiger_white:{id:"tiger_white",name:"Tigre Blanc",char:"T",color:"#f5fff5ff",health:{min:30,max:40},attack:{min:20,max:35},defense:5,aiType:"AGGRESSIVE",xpValue:50,spawnWeight:1}};function j(e,t){return Math.floor(Math.random()*(t-e+1))+e}function E(e){return{hp:j(e.health.min,e.health.max),attack:j(e.attack.min,e.attack.max)}}function M(){let e=Object.values(O),t=Math.random()*e.reduce((e,t)=>e+t.spawnWeight,0);for(let r of e)if((t-=r.spawnWeight)<=0)return r;return e[0]}function k(){let e=s.world.with("player"),t=null;for(let r of e){t=r.id||"player";break}return t?Array.from(s.world).filter(e=>e.item).filter(e=>e.inInventory).filter(e=>e.inInventory?.ownerId===t):[]}var N=e.i(36352);let A=({isOpen:e,onClose:i,onRerender:a})=>{let[l,u]=(0,r.useState)([]),[h,d]=(0,r.useState)(0),[f,p]=(0,r.useState)("ALL"),[g,y]=(0,r.useState)(null);(0,r.useEffect)(()=>{e&&(u(k()),d(0))},[e]);let x=l.filter(e=>"ALL"===f||("CONSUMABLES"===f?e.item?.type==="POTION"||e.item?.type==="FOOD"||e.item?.type==="SCROLL":"EQUIPMENT"===f?e.item?.type==="WEAPON"||e.item?.type==="ARMOR":"MISC"!==f||!["POTION","FOOD","SCROLL","WEAPON","ARMOR"].includes(e.item?.type||"")));(0,r.useEffect)(()=>{h>=x.length&&x.length>0&&d(x.length-1)},[x.length,h]);let b=e=>{if(function(e){if(!e.consumable)return{success:!1,message:"Item is not consumable"};let t=s.world.with("player","fighter"),r=null;for(let e of t){r=e;break}if(!r||!r.fighter)return{success:!1,message:"Player not found"};let i=e.consumable.effect,n=e.consumable.amount,o=e.name||"Unknown item";switch(i){case"HEAL_HP":{let e=r.fighter.hp;r.fighter.hp=Math.min(r.fighter.maxHp,r.fighter.hp+n);let t=r.fighter.hp-e;c.useGameStore.getState().setHp(r.fighter.hp),c.useGameStore.getState().addLog(`You use ${o} and restore ${t} HP.`,"green");break}case"BOOST_ATK":c.useGameStore.getState().addLog(`You use ${o}. ATK boost not yet implemented.`,"yellow");break;case"BOOST_DEF":c.useGameStore.getState().addLog(`You use ${o}. DEF boost not yet implemented.`,"yellow");break;case"CURE_POISON":c.useGameStore.getState().addLog(`You use ${o}. Poison cure not yet implemented.`,"yellow");break;default:return{success:!1,message:"Unknown effect"}}return m.spatialGrid.remove(e),s.world.remove(e),{success:!0,message:`Used ${o}`}}(e).success){let e=k();u(e),h>=e.length&&d(Math.max(0,e.length-1)),a()}},v=e=>{let t=(0,N.equipItem)(e);t.success?(u(k()),a()):(y(t.message),setTimeout(()=>y(null),3e3))},w=e=>{let t=(0,N.unequipItem)(e);t.success?(u(k()),a()):(y(t.message),setTimeout(()=>y(null),3e3))},_=e=>{let t=function(e){let t=s.world.with("player","position"),r=null;for(let e of t){r=e;break}if(!r||!r.position)return{success:!1,message:"Player not found"};let i=e.name||"Unknown item";return m.spatialGrid.getAt(r.position.x,r.position.y).filter(e=>e.item&&e!==r).length>0?{success:!1,message:"There is already an item here! Move to drop."}:(e.equipped&&(0,N.unequipItem)(e),s.world.removeComponent(e,"inInventory"),s.world.addComponent(e,"position",{x:r.position.x,y:r.position.y}),m.spatialGrid.add(e),c.useGameStore.getState().addLog(`You dropped ${i}.`,"gray"),{success:!0,message:`Dropped ${i}`})}(e);if(t.success){let e=k();u(e),h>=e.length&&d(Math.max(0,e.length-1)),y(null),a()}else y(t.message),setTimeout(()=>y(null),3e3)};if((0,r.useEffect)(()=>{if(!e)return;let t=e=>{if("Escape"===e.key||"i"===e.key.toLowerCase()){e.preventDefault(),i();return}if("ArrowUp"===e.key)e.preventDefault(),d(e=>Math.max(0,e-1));else if("ArrowDown"===e.key)e.preventDefault(),d(e=>Math.min(x.length-1,e+1));else if("ArrowLeft"===e.key){e.preventDefault();let t=["ALL","CONSUMABLES","EQUIPMENT","MISC"],r=t.indexOf(f),i=r>0?r-1:t.length-1;p(t[i])}else if("ArrowRight"===e.key){e.preventDefault();let t=["ALL","CONSUMABLES","EQUIPMENT","MISC"],r=t.indexOf(f),i=r<t.length-1?r+1:0;p(t[i])}else"Home"===e.key?(e.preventDefault(),d(0)):"End"===e.key?(e.preventDefault(),d(Math.max(0,x.length-1))):"PageUp"===e.key?(e.preventDefault(),d(e=>Math.max(0,e-10))):"PageDown"===e.key?(e.preventDefault(),d(e=>Math.min(x.length-1,e+10))):"Enter"===e.key||" "===e.key||"u"===e.key.toLowerCase()?(e.preventDefault(),x[h]&&b(x[h])):"e"===e.key.toLowerCase()?(e.preventDefault(),x[h]&&v(x[h])):"r"===e.key.toLowerCase()?(e.preventDefault(),x[h]&&w(x[h])):"1"===e.key?(e.preventDefault(),p("ALL")):"2"===e.key?(e.preventDefault(),p("CONSUMABLES")):"3"===e.key?(e.preventDefault(),p("EQUIPMENT")):"4"===e.key?(e.preventDefault(),p("MISC")):"d"===e.key.toLowerCase()&&(e.preventDefault(),x[h]&&_(x[h]))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,x,h,i,f]),!e)return null;let S=x[h];return(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9999,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,t.jsxs)("div",{className:"w-full max-w-4xl h-[80vh] bg-gray-900 border-4 border-gray-700 rounded-lg shadow-2xl flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between border-b-2 border-gray-700 bg-gray-800 px-6 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-3xl",children:""}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-yellow-500 font-mono",children:"INVENTORY"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-400 font-mono",children:["Carrying: ",(0,t.jsxs)("span",{className:"text-white font-bold",children:[l.length,"/",o.MAX_INVENTORY_SIZE]})]}),(0,t.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-white transition-colors text-2xl",children:""})]})]}),(0,t.jsx)("div",{className:"flex border-b-2 border-gray-700 bg-gray-800",children:["ALL","CONSUMABLES","EQUIPMENT","MISC"].map((e,r)=>(0,t.jsxs)("button",{onClick:()=>p(e),className:(0,n.default)("flex-1 py-3 px-4 font-mono text-sm font-bold transition-all",f===e?"bg-yellow-600 text-white border-b-4 border-yellow-400":"bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-gray-200"),children:[e," (","ALL"===e?l.length:l.filter(t=>"CONSUMABLES"===e?["POTION","FOOD","SCROLL"].includes(t.item?.type||""):"EQUIPMENT"===e?["WEAPON","ARMOR"].includes(t.item?.type||""):"MISC"===e&&!["POTION","FOOD","SCROLL","WEAPON","ARMOR"].includes(t.item?.type||"")).length,")",(0,t.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["[",r+1,"]"]})]},e))}),(0,t.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,t.jsx)("div",{className:"w-1/2 border-r-2 border-gray-700 bg-gray-850 overflow-y-auto",children:0===x.length?(0,t.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500 font-mono",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-xl mb-2",children:"Empty"}),(0,t.jsx)("p",{className:"text-sm",children:"No items in this category"})]})}):(0,t.jsx)("div",{className:"p-2",children:x.map((e,r)=>{let i=r===h,o=!!e.equipped,s=e.renderable?.char||"?",a=e.renderable?.color||"#fff",l=e.name||"Unknown item";return(0,t.jsxs)("div",{className:(0,n.default)("flex items-center gap-3 p-3 mb-2 rounded transition-all cursor-pointer relative",o&&i?"bg-yellow-600/30 border-l-4 border-blue-400 shadow-lg ring-2 ring-yellow-400":i?"bg-yellow-600/30 border-l-4 border-yellow-400 shadow-lg":o?"bg-blue-900/30 border-l-4 border-blue-400 hover:bg-blue-800/40":"bg-gray-800 hover:bg-gray-750"),onClick:()=>d(r),onDoubleClick:()=>b(e),children:[i&&(0,t.jsx)("div",{className:"text-yellow-400 text-xl font-bold animate-pulse",children:""}),o&&(0,t.jsx)("div",{className:"absolute -left-1 top-1/2 -translate-y-1/2 w-2 h-2 bg-blue-400 rounded-full animate-pulse"}),(0,t.jsx)("div",{className:"text-2xl font-mono w-10 h-10 flex items-center justify-center",style:{color:a},children:s}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-mono font-bold",style:{color:"#ffffff"},children:l}),o&&(0,t.jsxs)("div",{className:"text-xs text-blue-400 font-mono mt-1 flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-blue-400",children:""}),(0,t.jsx)("span",{className:"font-bold",children:"EQUIPPED"})]})]})]},r)})})}),(0,t.jsx)("div",{className:"w-1/2 bg-gray-900 p-6 overflow-y-auto",children:S?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold font-mono text-yellow-400",children:S.name||"Unknown Item"}),(0,t.jsx)("div",{className:"flex items-center justify-center p-8 bg-gray-800 rounded-lg border-2 border-gray-700",children:(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)("div",{className:"text-8xl font-mono",style:{color:S.renderable?.color||"#fff"},children:S.renderable?.char||"?"})})}),(0,t.jsx)("div",{className:"text-sm text-gray-400 italic",children:S.item?.description||"No description available."}),(0,t.jsxs)("div",{className:"space-y-2 border-t-2 border-gray-700 pt-4",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 font-mono uppercase mb-2",children:"Stats"}),S.consumable&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Effect:"}),(0,t.jsxs)("span",{className:"text-green-400 font-bold",children:["HEAL_HP"===S.consumable.effect&&`Restores ${S.consumable.amount} HP`,"BOOST_ATK"===S.consumable.effect&&`+${S.consumable.amount} ATK`,"BOOST_DEF"===S.consumable.effect&&`+${S.consumable.amount} DEF`]})]}),S.equippable&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Slot:"}),(0,t.jsx)("span",{className:"text-white",children:S.equippable.slot})]}),S.equippable.bonuses.attack&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Attack:"}),(0,t.jsxs)("span",{className:"text-green-400",children:["+",S.equippable.bonuses.attack]})]}),S.equippable.bonuses.defense&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Defense:"}),(0,t.jsxs)("span",{className:"text-green-400",children:["+",S.equippable.bonuses.defense]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Type:"}),(0,t.jsx)("span",{className:"text-white",children:S.item?.type||"Unknown"})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[S.consumable&&(0,t.jsx)("button",{onClick:()=>b(S),className:"flex-1 py-3 bg-green-600 hover:bg-green-500 text-white font-mono font-bold rounded transition-colors",children:"USE [U]"}),S.equippable&&(0,t.jsx)(t.Fragment,{children:S.equipped?(0,t.jsx)("button",{onClick:()=>w(S),className:"flex-1 py-3 bg-orange-600 hover:bg-orange-500 text-white font-mono font-bold rounded transition-colors",children:"UNEQUIP [R]"}):(0,t.jsx)("button",{onClick:()=>v(S),className:"flex-1 py-3 bg-blue-600 hover:bg-blue-500 text-white font-mono font-bold rounded transition-colors",children:"EQUIP [E]"})}),(0,t.jsx)("button",{onClick:()=>_(S),className:"flex-1 py-3 bg-red-600 hover:bg-red-500 text-white font-mono font-bold rounded transition-colors",children:"DROP [D]"})]})]}):(0,t.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:(0,t.jsx)("p",{className:"font-mono",children:"Select an item to view details"})})})]}),(0,t.jsx)("div",{className:"border-t-2 border-gray-700 bg-gray-800 px-6 py-3 text-xs text-gray-400 font-mono",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex gap-6",children:[(0,t.jsx)("span",{children:": Navigate Items"}),(0,t.jsx)("span",{children:": Categories"}),(0,t.jsx)("span",{children:"ENTER/U: Use"}),(0,t.jsx)("span",{children:"E: Equip"}),(0,t.jsx)("span",{children:"R: Unequip"}),(0,t.jsx)("span",{children:"D: Drop"})]}),(0,t.jsxs)("div",{className:"flex gap-6",children:[(0,t.jsx)("span",{children:"Home/End: Jump"}),(0,t.jsx)("span",{children:"ESC/I: Close"})]})]})})]}),g&&(0,t.jsx)("div",{className:"fixed top-20 left-1/2 transform -translate-x-1/2 z-[10001]",children:(0,t.jsx)("div",{className:"bg-red-600 border-4 border-red-400 rounded-lg px-6 py-4 shadow-2xl animate-pulse",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-3xl",children:""}),(0,t.jsx)("p",{className:"text-white font-mono font-bold",children:g})]})})})]})},R=["HELMET","AMULET","WEAPON","ARMOR","OFFHAND","RING"],I=({isOpen:e,onClose:i,onRerender:o,onSwitchToInventory:s})=>{let[a,l]=(0,r.useState)({}),[u,h]=(0,r.useState)(0),{hp:d,maxHp:f,attack:p,defense:m,level:g,currentXp:y,nextLevelXp:x}=(0,c.useGameStore)();if((0,r.useEffect)(()=>{if(e){let e=(0,N.getPlayerEquipment)(),t={};e.forEach(e=>{e.equippable?.slot&&(t[e.equippable.slot]=e)}),l(t)}},[e]),(0,r.useEffect)(()=>{if(!e)return;let t=e=>{if("Escape"===e.key||"c"===e.key.toLowerCase()){e.preventDefault(),i();return}if("i"===e.key.toLowerCase()){e.preventDefault(),s();return}if("ArrowRight"===e.key)e.preventDefault(),u%2==0&&h(Math.min(R.length-1,u+1));else if("ArrowLeft"===e.key)e.preventDefault(),u%2!=0&&h(Math.max(0,u-1));else if("ArrowDown"===e.key)e.preventDefault(),h(Math.min(R.length-1,u+2));else if("ArrowUp"===e.key)e.preventDefault(),h(Math.max(0,u-2));else if("u"===e.key.toLowerCase()){e.preventDefault();let t=a[R[u]];t&&(e=>{if((0,N.unequipItem)(e).success){let e=(0,N.getPlayerEquipment)(),t={};e.forEach(e=>{e.equippable?.slot&&(t[e.equippable.slot]=e)}),l(t),o()}})(t)}};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,u,a,i,s]),!e)return null;let b=0,v=0;Object.values(a).forEach(e=>{e.equippable?.bonuses.attack&&(b+=e.equippable.bonuses.attack),e.equippable?.bonuses.defense&&(v+=e.equippable.bonuses.defense)});let w=p-b,_=m-v;return(0,t.jsx)("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center bg-black/80 backdrop-blur-sm",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:1e4,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsxs)("div",{className:"w-full max-w-4xl h-[70vh] bg-gray-900 border-4 border-gray-700 rounded-lg shadow-2xl flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between border-b-2 border-gray-700 bg-gray-800 px-6 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-3xl",children:""}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-yellow-500 font-mono",children:"CHARACTER PROFILE"})]}),(0,t.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-white transition-colors text-2xl",children:""})]}),(0,t.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,t.jsx)("div",{className:"w-1/2 border-r-2 border-gray-700 p-8 bg-gray-850",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white font-mono mb-4 border-b border-gray-700 pb-2",children:"STATISTICS"}),(0,t.jsxs)("div",{className:"space-y-3 font-mono",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Name:"}),(0,t.jsx)("span",{className:"text-white font-bold",children:"Player"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Level:"}),(0,t.jsx)("span",{className:"text-white font-bold",children:g})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"XP:"}),(0,t.jsxs)("span",{className:"text-white font-bold",children:[y," / ",x]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-gray-400 font-mono",children:"HP"}),(0,t.jsxs)("span",{className:"text-white font-mono font-bold",children:[d," / ",f]})]}),(0,t.jsx)("div",{className:"w-full h-4 bg-gray-700 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-red-600",style:{width:`${Math.min(100,d/f*100)}%`}})})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center bg-gray-800 p-3 rounded",children:[(0,t.jsx)("span",{className:"text-gray-400 font-mono font-bold",children:"ATK (Attack)"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("span",{className:"text-white font-bold text-xl",children:w}),b>0&&(0,t.jsxs)("span",{className:"text-green-400 text-sm flex items-center",children:["(+",b,")"]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center bg-gray-800 p-3 rounded",children:[(0,t.jsx)("span",{className:"text-gray-400 font-mono font-bold",children:"DEF (Defense)"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("span",{className:"text-white font-bold text-xl",children:_}),v>0&&(0,t.jsxs)("span",{className:"text-green-400 text-sm flex items-center",children:["(+",v,")"]})]})]})]})]})}),(0,t.jsxs)("div",{className:"w-1/2 p-8 bg-gray-900",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white font-mono mb-6 border-b border-gray-700 pb-2",children:"EQUIPMENT"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-4",children:R.map((e,r)=>{let i=a[e],o=r===u;return(0,t.jsxs)("div",{onClick:()=>h(r),className:(0,n.default)("p-4 border-2 rounded transition-all cursor-pointer min-h-[100px] flex flex-col justify-between",o?"border-yellow-500 bg-yellow-900/20 shadow-[0_0_10px_rgba(234,179,8,0.2)]":"border-gray-700 bg-gray-800 hover:border-gray-500"),children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 font-mono font-bold mb-2",children:e}),i?(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-mono font-bold mb-1 truncate",style:{color:i.renderable?.color||"#fff"},children:[i.renderable?.char," ",i.name]}),(0,t.jsxs)("div",{className:"text-xs text-green-400 font-mono",children:[i.equippable?.bonuses.attack?`+${i.equippable.bonuses.attack} ATK`:"",i.equippable?.bonuses.attack&&i.equippable?.bonuses.defense?" ":"",i.equippable?.bonuses.defense?`+${i.equippable.bonuses.defense} DEF`:""]})]}):(0,t.jsx)("div",{className:"text-gray-600 italic font-mono text-sm",children:"(empty)"})]},e)})})]})]}),(0,t.jsx)("div",{className:"border-t-2 border-gray-700 bg-gray-800 px-6 py-3 text-xs text-gray-400 font-mono",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex gap-6",children:[(0,t.jsx)("span",{children:"Arrows: Select Slot"}),(0,t.jsx)("span",{children:"U: Unequip"}),(0,t.jsx)("span",{children:"I: Switch to Inventory"})]}),(0,t.jsx)("div",{className:"flex gap-6",children:(0,t.jsx)("span",{children:"ESC/C: Close"})})]})})]})})},P={POTION_HEAL_SMALL:{id:"POTION_HEAL_SMALL",name:"Potion de Soin Mineure",type:"POTION",rarity:"COMMON",description:"Restaure 20 HP",char:"!",color:"#ff66cc",consumable:{effect:"HEAL_HP",amount:20}},POTION_HEAL_LARGE:{id:"POTION_HEAL_LARGE",name:"Potion de Soin Majeure",type:"POTION",rarity:"UNCOMMON",description:"Restaure 50 HP",char:"!",color:"#ff0099",consumable:{effect:"HEAL_HP",amount:50}},POTION_STRENGTH:{id:"POTION_STRENGTH",name:"Potion de Force",type:"POTION",rarity:"RARE",description:"Augmente ATK de 5 pendant 20 tours",char:"!",color:"#ff6600",consumable:{effect:"BOOST_ATK",amount:5}},FOOD_BREAD:{id:"FOOD_BREAD",name:"Pain Rassis",type:"FOOD",rarity:"COMMON",description:"Restaure 5 HP",char:"%",color:"#d2691e",consumable:{effect:"HEAL_HP",amount:5}},FOOD_MEAT:{id:"FOOD_MEAT",name:"Viande Sche",type:"FOOD",rarity:"COMMON",description:"Restaure 15 HP",char:"%",color:"#8b4513",consumable:{effect:"HEAL_HP",amount:15}},SWORD_SHORT:{id:"SWORD_SHORT",name:"pe Courte",type:"WEAPON",rarity:"COMMON",description:"+5 ATK",char:"/",color:"#c0c0c0",equippable:{slot:"WEAPON",bonuses:{attack:5}}},SWORD_LONG:{id:"SWORD_LONG",name:"pe Longue",type:"WEAPON",rarity:"UNCOMMON",description:"+8 ATK",char:"/",color:"#ffffff",equippable:{slot:"WEAPON",bonuses:{attack:8}}},ARMOR_LEATHER:{id:"ARMOR_LEATHER",name:"Armure de Cuir",type:"ARMOR",rarity:"COMMON",description:"+3 DEF",char:"[",color:"#8b4513",equippable:{slot:"ARMOR",bonuses:{defense:3}}},ARMOR_CHAIN:{id:"ARMOR_CHAIN",name:"Cotte de Mailles",type:"ARMOR",rarity:"UNCOMMON",description:"+6 DEF",char:"[",color:"#c0c0c0",equippable:{slot:"ARMOR",bonuses:{defense:6}}}};function C(e){let t=P[e];if(!t)throw Error(`Unknown item template: ${e}`);return{name:t.name,renderable:{char:t.char,color:t.color},item:{type:t.type,description:t.description},...t.consumable&&{consumable:t.consumable},...t.equippable&&{equippable:t.equippable}}}e.s(["GameCanvas",0,()=>{var e;let d=(0,r.useRef)(null),g=(0,r.useRef)(null),[y,x]=(0,r.useState)(!1),[w,S]=(0,r.useState)(!1),[O,j]=(0,r.useState)(!1),N=(0,c.useGameStore)(e=>e.lastHitTime);(0,r.useEffect)(()=>{if(N>0){j(!0);let e=setTimeout(()=>j(!1),500);return()=>clearTimeout(e)}},[N]);let R=(0,r.useCallback)(()=>{let e=g.current;e&&h(e)},[]);return e=(0,r.useCallback)(e=>{if(!g.current)return;if(y){"inventory"===e.type&&x(!1),"character"===e.type&&(x(!1),S(!0));return}if(w){"character"===e.type&&S(!1),"inventory"===e.type&&(S(!1),x(!0));return}let t=s.world.with("player","position"),r=(()=>{for(let e of t)return e;return null})();if(r){if("move"===e.type){let i=function(e,t){let r=function(...e){return s.world.with("player",...e).first||null}("position");if(!r||!r.position)return{kind:"blocked"};let i=r.position.x,n=r.position.y,o=i+e,l=n+t;if(!(0,a.isInBounds)(o,l))return{kind:"blocked"};let c=(0,a.getTile)(o,l);if(null===c||c===a.TileType.WALL)return{kind:"blocked"};let u=m.spatialGrid.getFirstAt(o,l,r);if(u?.dead);else if(u?.monster)return{kind:"attacked",target:u};else if(u&&!u.item&&!u.stairs)return{kind:"blocked"};return r.position.x=o,r.position.y=l,m.spatialGrid.update(r,i,n),{kind:"moved",x:o,y:l}}(e.delta.dx,e.delta.dy);if("attacked"===i.kind)_(r,i.target);else if("blocked"===i.kind)return;c.useGameStore.getState().incrementTurn(),T();let n=(()=>{for(let e of t)return e;return null})();n?.position&&l.fovSystem.compute(n.position.x,n.position.y,8),R();return}if("wait"===e.type){c.useGameStore.getState().incrementTurn(),T();let e=(()=>{for(let e of t)return e;return null})();e?.position&&l.fovSystem.compute(e.position.x,e.position.y,8),R();return}if("pickup"===e.type){!function(){let e=s.world.with("player","position"),t=null;for(let r of e){t=r;break}if(!t||!t.position)return;let r=m.spatialGrid.getAt(t.position.x,t.position.y).filter(e=>e.item&&e!==t);if(0===r.length)return c.useGameStore.getState().addLog("There is nothing here to pick up.","gray");let i=r[0],n=i.name||"Unknown item",a=t.id||"player";k().length>=o.MAX_INVENTORY_SIZE?c.useGameStore.getState().addLog("Your inventory is full!","red"):(m.spatialGrid.remove(i),delete i.position,i.inInventory={ownerId:a},c.useGameStore.getState().addLog(`You pick up: ${n}`,"cyan"))}(),c.useGameStore.getState().incrementTurn(),R();return}if("inventory"===e.type)return void x(!0);if("character"===e.type)return void S(!0);if("save"===e.type)return void(0,b.saveGame)();if("descend"===e.type){let e=function(){let e=s.world.with("player","position").first;if(!e||!e.position)return{success:!1,message:"Player not found"};let t=Array.from(s.world.with("stairs","position")).find(t=>t.position.x===e.position.x&&t.position.y===e.position.y);return t?"UP"===t.stairs.direction?{success:!1,message:"The way back is sealed by magic."}:"DOWN"===t.stairs.direction?function(){let e=s.world.with("player","position").first;if(!e)return{success:!1,message:"Player not found"};let t=c.useGameStore.getState();t.nextFloor();let r=t.currentFloor,i=new Set;for(let t of(i.add(e),Array.from(s.world.with("item")).filter(t=>t.inInventory?.ownerId===e.id||t.equipped?.ownerId===e.id)))i.add(t);for(let e of s.world.entities.filter(e=>!i.has(e)))s.world.remove(e);(0,a.resetMap)(),l.fovSystem.reset();let{playerStart:n,rooms:u}=new f().generate();if(e.position={...n},l.fovSystem.compute(e.position.x,e.position.y,8),s.world.add({stairs:{direction:"UP"},position:{...n},renderable:{char:"<",color:"#fff",bg:"#333"}}),u.length>1){let e=u[u.length-1],t=Math.floor(e.x+e.w/2),r=Math.floor(e.y+e.h/2);s.world.add({stairs:{direction:"DOWN"},position:{x:t,y:r},renderable:{char:">",color:"#fff",bg:"#333"}})}return function(e,t){let r=[];for(let e=0;e<a.mapData.length;e++)a.mapData[e]===a.TileType.FLOOR&&r.push(e);let i=new Set([t.y*o.GRID_WIDTH+t.x]),n=Math.min(20,6+Math.floor(e/2));for(let t=0;t<n;t++){let t=r[Math.floor(Math.random()*r.length)];if(i.has(t))continue;i.add(t);let n=t%o.GRID_WIDTH,a=Math.floor(t/o.GRID_WIDTH),l=M(),c=E(l),u=1+(e-1)*.15;s.world.add({monster:!0,name:l.name,ai:{type:l.aiType},position:{x:n,y:a},renderable:{char:l.char,color:l.color},xpValue:l.xpValue,fighter:{hp:Math.floor(c.hp*u),maxHp:Math.floor(c.hp*u),attack:Math.floor(c.attack*u),defense:Math.floor(l.defense*u)}})}let l=Object.keys(P),c=Math.min(10,8+Math.floor(e/3));for(let e=0;e<c;e++){let e=r[Math.floor(Math.random()*r.length)];if(i.has(e))continue;i.add(e);let t=e%o.GRID_WIDTH,n=Math.floor(e/o.GRID_WIDTH),a=Math.random(),c=C(a<.4?"POTION_HEAL_SMALL":a<.7?"FOOD_BREAD":a<.85?"FOOD_MEAT":l[Math.floor(Math.random()*l.length)]);s.world.add({...c,position:{x:t,y:n}})}}(r,n),m.spatialGrid.rebuild(s.world.entities),t.addLog(`You descend to depth ${r}.`,"cyan"),(0,b.saveGame)(),{success:!0,message:`Descended to level ${r}`}}():{success:!1,message:"These stairs go nowhere?"}:{success:!1,message:"No stairs here."}}();e.success?(c.useGameStore.getState().incrementTurn(),R()):c.useGameStore.getState().addLog(e.message,"gray");return}}},[R,y,w]),(0,r.useEffect)(()=>{function t(t){var r,i;if(t.defaultPrevented||function(e){if(!(e instanceof HTMLElement))return!1;if(e.isContentEditable)return!0;let t=e.tagName.toLowerCase();return"input"===t||"textarea"===t||"select"===t}(t.target))return;let n=p[1===(r=t.key).length?r.toLowerCase():r]??null;if(n){t.preventDefault(),e({type:"move",delta:n});return}if(" "===(i=t.key)||"."===i||"5"===i){t.preventDefault(),e({type:"wait"});return}if("g"===t.key.toLowerCase()){t.preventDefault(),e({type:"pickup"});return}if("i"===t.key.toLowerCase()){t.preventDefault(),e({type:"inventory"});return}if("c"===t.key.toLowerCase()){t.preventDefault(),e({type:"character"});return}if("s"===t.key.toLowerCase()){t.preventDefault(),e({type:"save"});return}if("Enter"===t.key||">"===t.key||"."===t.key){t.preventDefault(),e({type:"descend"});return}}return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e]),(0,r.useEffect)(()=>{if(!d.current)return;let e=new i.default({width:o.GRID_WIDTH,height:o.GRID_HEIGHT,fontSize:o.FONT_SIZE,bg:o.BG_COLOR,forceSquareRatio:!0});g.current=e;let t=d.current,r=e.getContainer();if(r&&t.appendChild(r),(0,u.setParticleDisplay)(e),(0,u.setParticleRenderer)(R),s.world.clear(),(0,a.resetMap)(),l.fovSystem.reset(),(0,b.hasSave)()&&(0,b.loadGame)())return h(e),()=>{r&&t.removeChild(r)};let{playerStart:n,rooms:p}=new f().generate(),y={hp:100,maxHp:100,attack:10,defense:5,baseAttack:10,baseDefense:5},x=s.world.add({id:"player",player:!0,name:"Player",position:n,renderable:{char:"@",color:"#ff0"},fighter:y});if((0,v.initializeExperience)(x),s.world.add({stairs:{direction:"UP"},position:{...n},renderable:{char:"<",color:"#fff",bg:"#333"}}),p.length>1){let e=p[p.length-1],t=Math.floor(e.x+e.w/2),r=Math.floor(e.y+e.h/2);s.world.add({stairs:{direction:"DOWN"},position:{x:t,y:r},renderable:{char:">",color:"#fff",bg:"#333"}})}c.useGameStore.getState().setHp(y.hp),c.useGameStore.getState().setMaxHp(y.maxHp),c.useGameStore.getState().setStats({attack:y.attack,defense:y.defense}),c.useGameStore.getState().addLog("Welcome to the dungeon!","cyan");let w=[];for(let e=0;e<a.mapData.length;e++)a.mapData[e]===a.TileType.FLOOR&&w.push(e);let _=new Set([n.y*o.GRID_WIDTH+n.x]),S=Math.min(6,Math.max(0,w.length-1));for(let e=0;e<S;e++){let e=w[Math.floor(Math.random()*w.length)];if(_.has(e))continue;_.add(e);let t=e%o.GRID_WIDTH,r=Math.floor(e/o.GRID_WIDTH),i=M(),n=E(i);s.world.add({monster:!0,name:i.name,ai:{type:i.aiType},position:{x:t,y:r},renderable:{char:i.char,color:i.color},xpValue:i.xpValue,fighter:{hp:n.hp,maxHp:n.hp,attack:n.attack,defense:i.defense}})}let T=Object.keys(P),O=Math.min(8,Math.max(0,w.length-S-1));for(let e=0;e<O;e++){let e=w[Math.floor(Math.random()*w.length)];if(_.has(e))continue;_.add(e);let t=e%o.GRID_WIDTH,r=Math.floor(e/o.GRID_WIDTH),i=Math.random(),n=C(i<.4?"POTION_HEAL_SMALL":i<.7?"FOOD_BREAD":i<.85?"FOOD_MEAT":T[Math.floor(Math.random()*T.length)]);s.world.add({...n,position:{x:t,y:r}})}return m.spatialGrid.rebuild(s.world.entities),l.fovSystem.compute(n.x,n.y,8),h(e),()=>{r&&t.removeChild(r)}},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:(0,n.default)("flex flex-col items-center justify-center bg-black p-4 rounded-lg shadow-2xl border border-gray-800 transition-transform",O&&"animate-shake border-red-500"),children:[(0,t.jsx)("div",{ref:d,className:"overflow-hidden rounded shadow-inner",style:{width:"fit-content"}}),(0,t.jsxs)("div",{className:"mt-4 text-xs text-gray-500 font-mono",children:[o.GRID_WIDTH,"x",o.GRID_HEIGHT," Grid - Powered by Rot.js"]})]}),(0,t.jsx)(A,{isOpen:y,onClose:()=>x(!1),onRerender:R}),(0,t.jsx)(I,{isOpen:w,onClose:()=>S(!1),onRerender:R,onSwitchToInventory:()=>{S(!1),x(!0)}})]})}],35581)},64214,e=>{"use strict";var t=e.i(43476),r=e.i(11742),i=e.i(7670);e.s(["HealthBar",0,()=>{let e=(0,r.useGameStore)(e=>e.hp),n=(0,r.useGameStore)(e=>e.maxHp),o=(0,r.useGameStore)(e=>e.level),s=(()=>{if(n<=0)return 0;let t=e/n*100;return Number.isFinite(t)?Math.max(0,Math.min(100,t)):0})(),a=s<20,l=(0,r.useGameStore)(e=>e.currentFloor);return(0,t.jsxs)("div",{className:"w-64 space-y-1",children:[(0,t.jsx)("div",{className:"flex justify-between items-end mb-2",children:(0,t.jsxs)("span",{className:"text-yellow-500 font-bold font-mono text-xl",children:["FLOOR ",l]})}),(0,t.jsx)("div",{className:"flex justify-between text-xs text-gray-300 font-mono",children:(0,t.jsxs)("span",{children:["HP: ",e," / ",n," LV: ",o]})}),(0,t.jsx)("progress",{className:(0,i.default)("health-progress w-full border-2 border-gray-700",a&&"animate-pulse"),max:n>0?n:1,value:Math.max(0,Math.min(n,e)),style:{color:a?"#dc2626":s<50?"#eab308":"#22c55e"}})]})}])},80239,e=>{"use strict";var t=e.i(43476),r=e.i(11742),i=e.i(71645),n=e.i(7670);let o={white:"text-white",red:"text-red-400",yellow:"text-yellow-400",green:"text-green-400",cyan:"text-cyan-400",purple:"text-purple-400 font-bold",gray:"text-gray-500"};e.s(["MessageLog",0,()=>{let e=(0,r.useGameStore)(e=>e.log),s=(0,i.useRef)(null);(0,i.useEffect)(()=>{s.current&&(s.current.scrollTop=s.current.scrollHeight)},[e]);let a=e.slice(-10);return(0,t.jsxs)("div",{className:"w-full max-w-xl",children:[(0,t.jsx)("div",{className:"text-xs text-gray-400 font-mono mb-1 px-2",children:"COMBAT LOG"}),(0,t.jsx)("div",{ref:s,className:"h-48 bg-black/70 border-2 border-gray-700 rounded p-3 overflow-y-auto backdrop-blur-sm",children:(0,t.jsx)("div",{className:"space-y-1 font-mono text-sm",children:0===a.length?(0,t.jsx)("p",{className:"text-gray-600 italic",children:"No messages yet..."}):a.map((e,r)=>(0,t.jsxs)("div",{className:(0,n.default)("leading-relaxed animate-fade-in",o[e.color]||"text-white"),children:[(0,t.jsx)("span",{className:"text-gray-600 mr-2",children:">"}),e.text]},`${e.turn}-${r}`))})})]})}])},64808,e=>{"use strict";var t=e.i(43476),r=e.i(74080),i=e.i(11742),n=e.i(15089);e.s(["GameOverModal",0,()=>{let{gameStatus:e,currentTurn:o,currentFloor:s}=(0,i.useGameStore)();return"GAME_OVER"!==e?null:(0,r.createPortal)((0,t.jsx)("div",{className:"fixed inset-0 z-[10001] flex items-center justify-center bg-black",style:{position:"fixed",inset:0,zIndex:10001},children:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 border-4 border-red-800 rounded-lg shadow-2xl w-[80vw] max-w-[460px] text-center opacity-100",style:{backgroundColor:"#000"},children:[(0,t.jsx)("h1",{className:"text-6xl font-bold text-red-600 font-mono mb-2 animate-pulse",children:"YOU DIED"}),(0,t.jsx)("div",{className:"w-full h-1 bg-red-900 mb-6"}),(0,t.jsxs)("div",{className:"space-y-4 mb-8 text-gray-300 font-mono",children:[(0,t.jsx)("p",{className:"text-xl",children:"Your journey ends here."}),(0,t.jsxs)("div",{className:"bg-gray-900 p-4 rounded border border-gray-800",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("p",{className:"text-gray-500 text-sm uppercase mb-1",children:"Depth Reached"}),(0,t.jsxs)("p",{className:"text-3xl text-yellow-500 font-bold",children:["Floor ",s]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500 text-sm uppercase mb-1",children:"YOU MOVED"}),(0,t.jsxs)("p",{className:"text-3xl text-white font-bold",children:[o," TIMES"]})]})]})]}),(0,t.jsx)("button",{onClick:()=>{(0,n.deleteSave)(),window.location.reload()},className:"px-8 py-4 bg-red-700 hover:bg-red-600 text-white font-bold font-mono text-xl rounded transition-colors shadow-lg w-full",children:"RESTART GAME"})]})}),document.body)}])},22123,e=>{"use strict";var t=e.i(43476),r=e.i(11742),i=e.i(15089);e.s(["VictoryModal",0,()=>{let{gameStatus:e,currentTurn:n}=(0,r.useGameStore)();return"VICTORY"!==e?null:(0,t.jsx)("div",{className:"fixed inset-0 z-[10001] flex items-center justify-center bg-black/90 backdrop-blur-md",children:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 border-4 border-yellow-500 bg-gray-950 rounded-lg shadow-2xl max-w-lg w-full text-center",children:[(0,t.jsx)("h1",{className:"text-6xl font-bold text-yellow-500 font-mono mb-2 animate-bounce",children:"VICTORY!"}),(0,t.jsx)("div",{className:"w-full h-1 bg-yellow-700 mb-6"}),(0,t.jsxs)("div",{className:"space-y-4 mb-8 text-gray-300 font-mono",children:[(0,t.jsx)("p",{className:"text-xl",children:"You have conquered the dungeon!"}),(0,t.jsxs)("div",{className:"bg-gray-900 p-4 rounded border border-gray-800",children:[(0,t.jsx)("p",{className:"text-gray-500 text-sm uppercase mb-1",children:"Turns Taken"}),(0,t.jsx)("p",{className:"text-3xl text-white font-bold",children:n})]})]}),(0,t.jsx)("button",{onClick:()=>{(0,i.deleteSave)(),window.location.reload()},className:"px-8 py-4 bg-yellow-600 hover:bg-yellow-500 text-white font-bold font-mono text-xl rounded transition-colors shadow-lg w-full",children:"PLAY AGAIN"})]})})}])}]);